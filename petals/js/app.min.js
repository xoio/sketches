var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(r,w,v){if(v.get||v.set)throw new TypeError("ES3 does not support getters and setters.");r!=Array.prototype&&r!=Object.prototype&&(r[w]=v.value)};$jscomp.getGlobal=function(r){return"undefined"!=typeof window&&window===r?r:"undefined"!=typeof global&&null!=global?global:r};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(r){return $jscomp.SYMBOL_PREFIX+(r||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var r=$jscomp.global.Symbol.iterator;r||(r=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[r]&&$jscomp.defineProperty(Array.prototype,r,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(r){var w=0;return $jscomp.iteratorPrototype(function(){return w<r.length?{done:!1,value:r[w++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(r){$jscomp.initSymbolIterator();r={next:r};r[$jscomp.global.Symbol.iterator]=function(){return this};return r};$jscomp.makeIterator=function(r){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var w=r[Symbol.iterator];return w?w.call(r):$jscomp.arrayIterator(r)};$jscomp.arrayFromIterator=function(r){for(var w,v=[];!(w=r.next()).done;)v.push(w.value);return v};$jscomp.arrayFromIterable=function(r){return r instanceof Array?r:$jscomp.arrayFromIterator($jscomp.makeIterator(r))};
$jscomp.inherits=function(r,w){function v(){}v.prototype=w.prototype;r.prototype=new v;r.prototype.constructor=r;for(var z in w)if(Object.defineProperties){var F=Object.getOwnPropertyDescriptor(w,z);F&&Object.defineProperty(r,z,F)}else r[z]=w[z]};$jscomp.owns=function(r,w){return Object.prototype.hasOwnProperty.call(r,w)};
$jscomp.polyfill=function(r,w,v,z){if(w){v=$jscomp.global;r=r.split(".");for(z=0;z<r.length-1;z++){var F=r[z];F in v||(v[F]={});v=v[F]}r=r[r.length-1];z=v[r];w=w(z);w!=z&&null!=w&&$jscomp.defineProperty(v,r,{configurable:!0,writable:!0,value:w})}};$jscomp.polyfill("Object.assign",function(r){return r?r:function(r,v){for(var w=1;w<arguments.length;w++){var F=arguments[w];if(F)for(var Q in F)$jscomp.owns(F,Q)&&(r[Q]=F[Q])}return r}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.fill",function(r){return r?r:function(r,v,z){var w=this.length||0;0>v&&(v=Math.max(0,w+v));if(null==z||z>w)z=w;z=Number(z);0>z&&(z=Math.max(0,w+z));for(v=Number(v||0);v<z;v++)this[v]=r;return this}},"es6-impl","es3");
(function(r,w){"object"===typeof exports&&"undefined"!==typeof module?w():"function"===typeof define&&define.amd?define(w):w()})(this,function(){function r(a,b){(window.jraDebug||(void 0===b?0:b))&&console.log("%c "+a,"background:red;color:white; padding-left:2px; padding-right:2px;")}function w(a,b){b=void 0===b?3:b;for(var c=[],d=a.length,e=0;e<d;++e){var f=a[e];3===b?c.push(f[0],f[1],f[2]):c.push(f[0],f[1])}return c=c.map(function(a){return void 0===a||null===a?0:a})}function v(a,b){return[a[0]+
b[0],a[1]+b[1],a[2]+b[2]]}function z(a,b){return[a[0]*b,a[1]*b,a[2]*b]}function F(a){for(var b=0,c=0;c<a.length;c++)b+=a[c]*a[c];b=Math.sqrt(b);if(0===b)return Array.apply(null,Array(a.length)).map(Number.prototype.valueOf,0);for(c=0;c<a.length;c++)a[c]/=b;return a}function Q(a,b){for(var c=[];a<b;)c.push(a),a+=1;return c}function ka(a,b){a=void 0===a?0:a;return a+Math.random()*((void 0===b?1:b)-a+1)}function la(a,b){a=void 0===a?0:a;return Math.floor(a+Math.random()*((void 0===b?1:b)-a+1))}function ma(a,
b,c){return b<c?a<b?b:a>c?c:a:a<c?c:a>b?b:a}function na(a){var b={};"OES_texture_float OES_vertex_array_object ANGLE_instanced_arrays OES_texture_half_float OES_texture_float_linear OES_texture_half_float_linear WEBGL_color_buffer_float EXT_color_buffer_half_float OES_standard_derivatives WEBGL_draw_buffers WEBGL_depth_texture".split(" ").forEach(function(c){var d=a.getExtension(c);null===d&&window.jraDebug&&console.log("%c "+("Unable to get extension "+c+", things might look weird or just plain fail"),
"background:yellow;color:red; padding-left:2px; padding-right:2px;");b[c]=d});return b}function oa(a,b,c){a=void 0===a?null:a;b=void 0===b?{}:b;c=void 0===c?!1:c;var d=null!==a?a:document.createElement("canvas"),e=!1;a={alpha:!0,antialias:!0,depth:!0};for(var f in a)b.hasOwnProperty(f)&&(a[f]=b[f]);for(f in b)a[f]=b[f];b=a;f=[];f=c?["webgl","experimental-webgl"]:["webgl2","experimental-webgl2","webgl","experimental-webgl"];c=f.map(function(a){var c=d.getContext(a,b);if(null!==c){if("webgl2"===a||
"experimental-webgl2"===a)e=!0;return c}}).filter(function(a){if(void 0!==a)return a});window.hasWebGL2=e?!0:!1;c[0].isWebGL2=e;return c[0]}function pa(){var a=k.create(),b=k.create(),c=k.create(),d=n.create(0,0,0),e=n.create(0,0,-1);k.create();var f=n.create(0,1,0),h=n.create(),g=n.create();return{type:"camera",position:d,projection:a,view:b,inverseView:c,eye:g,center:h,up:f,zoom:0,direction:e,lookAt:function(a,b){b=void 0===b?null:b;this.eye=n.clone(a);this.center=null!==b?n.clone(b):this.center;
n.copy(this.position,a);k.identity(this.view);k.lookAt(this.view,a,this.center,this.up)},update:function(a,b,c){this.up=c;this.direction=b;this.lookAt(a)},translate:function(a,b,c){},setProjection:function(a){this.projection=k.clone(a)},setView:function(a){this.view=k.clone(a)},getProjection:function(){return this.projection},getView:function(){return this.view},getInverseView:function(){k.identity(this.inverseView);return k.invert(this.inverseView,this.view)}}}function X(a,b){var c=void 0===b?{}:
b;b=void 0===c.data?null:c.data;var d=void 0===c.usage?"STATIC_DRAW":c.usage,e=null,f="ARRAY_BUFFER";!0===(void 0===c.indexed?!1:c.indexed)&&(f="ELEMENT_ARRAY_BUFFER");c=f;f=a[f];d=a[d];e=a.createBuffer();a={gl:a,buffer:e,bufferTypeName:c,type:f,usage:d,raw:function(){return this.buffer},updateBuffer:function(a){a instanceof Array&&(a="ARRAY_BUFFER"===this.bufferTypeName?new Float32Array(a):new Uint16Array(a));this.bind();this.gl.bufferSubData(this.type,0,a);this.unbind()},fill:function(a,b){b=void 0!==
b?b:this.gl.STATIC_DRAW;a instanceof Array&&(a="ARRAY_BUFFER"===this.bufferTypeName?new Float32Array(a):new Uint16Array(a));this.bind();this.gl.bufferData(this.type,a,b);this.unbind();this.data=a},bufferData:function(a){a instanceof Array&&(a="ARRAY_BUFFER"===this.bufferTypeName?new Float32Array(a):new Uint16Array(a));this.gl.bufferData(this.type,a,d);this.data=a},bind:function(){this.gl.bindBuffer(this.type,this.buffer)},unbind:function(){this.gl.bindBuffer(this.type,null)}};null!==b&&(a.bind(),
a.bufferData(b),a.unbind());return a}function qa(a,b){var c=null,d=null;if(void 0===b||b)a instanceof WebGL2RenderingContext?c=a.createVertexArray():(d=a.hasOwnProperty("OES_vertex_array_object")?a.OES_vertex_array_object:a.getExtension("OES_vertex_array_object"),c=d.createVertexArrayOES());return{gl:a,vao:c,ext:d,attributes:{},makeInstancedAttribute:function(b){if(null===a.vertexAttribDivisor||void 0===a.vertexAttribDivisor){var c=null;if(a.hasOwnProperty("ANGLE_instanced_arrays"))c=a.ANGLE_instanced_arrays;
else try{c=a.getExtension("ANGLE_instanced_arrays")}catch(h){return console.error("cannot utilize instanced attributes on this GPU"),!1}c.vertexAttribDivisorANGLE(this.getAttribute(b),1)}else a.vertexAttribDivisor(this.getAttribute(b),1)},setAttributeLocation:function(a,b,c){c=void 0===c?null:c;var d=this.gl;return null===c||void 0===c?d.getAttribLocation(a,b):d.bindAttribLocation(a,c,b)},enableAttributes:function(a){var b=a.attributes,c;for(c in b){var d=b[c],e=this.attributes.length;d.hasOwnProperty("location")&&
(e=d.location);this.addAttribute(a,d.name,d.size,e)}return this},addAttribute:function(a,b,c){var d=void 0===c?{}:c;c=void 0===d.size?3:d.size;var e=d.location,d=void 0===d.dataOptions?{}:d.dataOptions,f=this.attributes.length;a=a instanceof WebGLProgram?a:a.program;void 0===e&&(f=e);e=this.setAttributeLocation(a,b,f);this.attributes[b]={loc:e,enabled:!0,size:c};this.enableAttribute(b);this.setData(b,d);return this},getAttribute:function(a){return this.attributes[a].loc},vertexAttribPointer:function(a,
b){var c=void 0===b?{}:b;b=void 0===c.size?3:c.size;this.gl.vertexAttribPointer(a,b,void 0===c.type?FLOAT:c.type,void 0===c.normalized?!1:c.normalized,void 0===c.stride?0:c.stride,void 0===c.offset?0:c.offset)},enableAttribute:function(a){"number"===typeof a?this.gl.enableVertexAttribArray(a):this.gl.enableVertexAttribArray(this.attributes[a].loc)},disableAttribute:function(a){"number"===typeof a?this.gl.disableVertexAttribArray(a):this.gl.disableVertexAttribArray(this.attributes[a].loc)},setData:function(b,
c){c=void 0===c?{}:c;a.vertexAttribPointer(this.attributes[b].loc,this.attributes[b].size,void 0===c.type?a.FLOAT:c.type,void 0===c.normalized?a.FALSE:c.normalized,void 0===c.stride?0:c.stride,void 0===c.offset?0:c.offset)},bind:function(){a instanceof WebGL2RenderingContext?this.gl.bindVertexArray(this.vao):d.bindVertexArrayOES(this.vao)},unbind:function(){a instanceof WebGL2RenderingContext?this.gl.bindVertexArray(null):d.bindVertexArrayOES(null)}}}function U(a,b){return a instanceof WebGLRenderingContext?
b.webgl1:b.webgl2}function ba(a,b,c){var d=a.createShader(b);b=b===a.FRAGMENT_SHADER?"FRAGMENT":"VERTEX";a.shaderSource(d,c);a.compileShader(d);if(a.getShaderParameter(d,a.COMPILE_STATUS))return d;r("Error in "+b+" shader compilation - "+a.getShaderInfoLog(d),!0);return!1}function ra(a,b,c,d){d=void 0===d?null:d;b=ba(a,a.VERTEX_SHADER,b);c=ba(a,a.FRAGMENT_SHADER,c);if(!1!==b&&!1!==c){var e=a.createProgram();a.attachShader(e,b);a.attachShader(e,c);a.isWebGL2&&null!==d&&a.transformFeedbackVaryings(e,
d.varyings,d.mode);a.linkProgram(e);a.deleteShader(b);a.deleteShader(c);if(a.getProgramParameter(e,a.LINK_STATUS))return e;r("Could not initialize WebGLProgram");throw"Couldn't link shader program - "+a.getProgramInfoLog(e);}}function sa(a,b,c){a=void 0===a?null:a;c=void 0===c?null:c;var d={},e={},f=void 0!==b.precision?b.precision:"highp",h=void 0!==b.version?b.version:"#version 300 es \n";if(null===a)return console.error("createShader requires a WebGL context"),!1;if(!b.hasOwnProperty("vertex")||
!b.hasOwnProperty("fragment"))return r("spec does not contain vertex and/or fragment shader",!0),!1;b.vertex instanceof Array?(a instanceof WebGL2RenderingContext?b.vertex.unshift(h):a instanceof WebGLRenderingContext&&b.vertex.unshift("#version 120 es"),b.vertex=b.vertex.join("")):a instanceof WebGL2RenderingContext&&(b.vertex=h+b.vertex);b.fragment instanceof Array?(b.fragment.unshift("precision "+f+" float;"),a instanceof WebGL2RenderingContext?b.fragment.unshift(h):a instanceof WebGLRenderingContext&&
b.fragment.unshift("#version 120 es \n"),b.fragment=b.fragment.join("")):a instanceof WebGL2RenderingContext&&(b.fragment=h+("\n precision "+f+" float; \n")+b.fragment);var g=ra(a,b.vertex,b.fragment,c);if(b.hasOwnProperty("uniforms"))if(b.uniforms instanceof Object&&!b.uniforms instanceof Array)for(var m in b.uniforms)c=b.uniforms[m],f=a.getUniformLocation(g,m),d[m]={},d[m].loc=f,d[m].function=c[0],d[m].value=c[1];else b.uniforms instanceof Array&&b.uniforms.map(function(b){if("string"===typeof b){var c=
a.getUniformLocation(g,b);null!==c&&(d[b]=c)}else if("object"===typeof b){c=null;if(b.hasOwnProperty("buffer"))try{c=a.getUniformBlockIndex(g,b.name)}catch(p){r("Attempt to get UBO location when UBOs are not yet supported by your computer",!0)}else c=a.getUniformLocation(g,b.name);d[b.name]=c}});b.hasOwnProperty("attributes")&&b.attributes.map(function(a){e[a[0]]={size:a[1],name:a[0]};void 0!==a[2]&&(e[a[0]].location=a[2])});return{gl:a,program:g,uniforms:d,attributes:e,bind:function(a){var b=void 0===
a?{}:a;a=void 0===b.camera?null:b.camera;var c=void 0===b.projection?"projectionMatrix":b.projection,b=void 0===b.view?"modelViewMatrix":b.view;this.gl.useProgram(this.program);null!==a&&(this.set4x4Uniform(c,a.projection),this.set4x4Uniform(b,a.view))},setMatrixUniform:function(a,b){this.gl.uniformMatrix4fv(this.uniforms[a],!1,b)},set4x4Uniform:function(a,b){this.gl.uniformMatrix4fv(this.uniforms[a],!1,b)},set3x3Uniform:function(a,b){var c=this.uniforms[a];c instanceof Object?this.gl.uniformMatrix3fv(c.loc,
!1,b):this.gl.uniformMatrix3fv(this.uniforms[a],!1,b)},setTextureUniform:function(a,b){this.gl.uniform1i(this.uniforms[a],b)},getUniform:function(a){return this.uniforms[a]},setVec2:function(a,b,c){this.gl.uniform2f(this.uniforms[a],b,c)},setVec3:function(a,b){this.gl.uniform3fv(this.uniforms[a],b)},uniform:function(a,b){void 0!==b.length&&16===b.length?this.set4x4Uniform(a,b):void 0!==b.length&&3===b.length?this.gl.uniform3fv(this.uniforms[a],b):void 0!==b.length&&2===b.length?this.setVec2(a,b[0],
b[1]):void 0!==b.length&&3===b.length?this.setVec3(a,b):this.gl.uniform1f(this.uniforms[a],b)}}}function ta(a,b){var c=void 0===b?{}:b;b=void 0===c.width?128:c.width;var d=void 0===c.height?128:c.height,c=c.depthType,e=a.createTexture(),c=void 0!==c?c:a.DEPTH_COMPONENT;a instanceof WebGL2RenderingContext&&(c=a.DEPTH_COMPONENT16);var f=CLAMP_TO_EDGE,h=CLAMP_TO_EDGE,g=LINEAR,m=LINEAR;a.bindTexture(a.TEXTURE_2D,e);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,m);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,
g);a.texParameteri(TEXTURE_2D,WRAP_S,f);a.texParameteri(TEXTURE_2D,WRAP_T,h);a instanceof WebGLRenderingContext?a.texImage2D(a.TEXTURE_2D,0,c,b,d,0,c,a.UNSIGNED_SHORT,null):a.texImage2D(a.TEXTURE_2D,0,c,b,d,0,a.DEPTH_COMPONENT,a.UNSIGNED_SHORT,null);a.bindTexture(a.TEXTURE_2D,null);return e}function W(a,b,c){var d=a.createTexture();a.bindTexture(TEXTURE_2D,d);a.texImage2D(a.TEXTURE_2D,0,c.internalFormat,c.width,c.height,0,c.format,c.texelType,b);a.texParameteri(TEXTURE_2D,MAG_FILTER,c.magFilter);
a.texParameteri(TEXTURE_2D,MIN_FILTER,c.minFilter);a.texParameteri(TEXTURE_2D,WRAP_S,c.wrapS);a.texParameteri(TEXTURE_2D,WRAP_T,c.wrapT);c.generateMipMaps&&a.generateMipmap(TEXTURE_2D);a.bindTexture(TEXTURE_2D,null);d.contents=b;return d}function ua(a,b,c){var d=a.createTexture();a.bindTexture(TEXTURE_2D,d);a.texImage2D(TEXTURE_2D,0,c.format,c.format,c.texelType,b);a.texParameteri(TEXTURE_2D,MAG_FILTER,c.magFilter);a.texParameteri(TEXTURE_2D,MIN_FILTER,c.minFilter);a.texParameteri(TEXTURE_2D,WRAP_S,
c.wrapS);a.texParameteri(TEXTURE_2D,WRAP_T,c.wrapT);c.generateMipMaps&&a.generateMipmap(TEXTURE_2D);a.bindTexture(TEXTURE_2D,null);d.contents=b;return d}function va(a){var b=void 0===a?{}:a;a=void 0===b.format?RGBA:b.format;var c=void 0===b.internalFormat?RGBA:b.internalFormat,d=void 0===b.texelType?UNSIGNED_BYTE:b.texelType,e=void 0===b.wrapS?CLAMP_TO_EDGE:b.wrapS,f=void 0===b.wrapT?CLAMP_TO_EDGE:b.wrapT,h=void 0===b.minFilter?LINEAR:b.minFilter,g=void 0===b.magFilter?LINEAR:b.magFilter,m=void 0===
b.generateMipMaps?!1:b.generateMipMaps,b=void 0===b.depth?!1:b.depth;!1!==b&&(b=gl.DEPTH_COMPONENT);return{format:a,internalFormat:c,wrapS:e,wrapT:f,texelType:d,minFilter:h,magFilter:g,generateMipMaps:m,depth:b}}function K(a,b){var c=void 0===b?{}:b;b=c.data;var d=void 0===c.floatingPoint?!1:c.floatingPoint,e=void 0===c.width?128:c.width,f=void 0===c.height?128:c.height,h=void 0===c.randomInit?!1:c.randomInit,g=null,c=void 0===c.textureFormat?null:c.textureFormat;null===c&&(c=va());if(void 0===b){b=
null;a instanceof WebGL2RenderingContext&&!0===d&&(a.getExtension("EXT_color_buffer_float"),c.internalFormat=a.RGBA16F,c.texelType=a.FLOAT);a instanceof WebGLRenderingContext&&!0===d&&(c.texelType=a.FLOAT);b=c.texelType===FLOAT?new Float32Array(e*f*4):new Uint8Array(e*f*4);if(h){for(d=0;d<e*f*4;d+=4)b[d]=2*Math.random(),b[d+1]=2*Math.random(),b[d+2]=2*Math.random(),b[d+3]=1;c.data=b}c.width=e;c.height=f;g=W(a,b,c)}else c.width=e,c.height=f,a instanceof WebGL2RenderingContext&&!0===d&&(a.getExtension("EXT_color_buffer_float"),
c.internalFormat=a.RGBA16F,c.texelType=a.FLOAT),a instanceof WebGLRenderingContext&&!0===d&&(c.texelType=a.FLOAT),b instanceof Image&&(g=ua(a,b,c)),b instanceof Float32Array&&(g=W(a,b,c)),b instanceof Uint8Array&&(c.type!==FLOAT&&(c.type=FLOAT),g=W(a,b,c)),b instanceof Array&&(c.type!==FLOAT&&(c.type=FLOAT),g=W(a,new Float32Array(b),c)),c.data=b;return{gl:a,texture:g,raw:g,settings:c,name:"Texture",getTexture:function(){return this.texture},resize:function(b,c){var d=this.settings;this.settings.width=
b;this.settings.height=c;var e=this.gl,e=e.getParameter(e.MAX_TEXTURE_SIZE);0>b||b>e||0>c||c>e?(r("Invalid texture shape specified",!0),b=!1):b=!0;b&&(this.bind(),a.texImage2D(TEXTURE_2D,0,d.internalFormat,this.settings.width,this.settings.height,0,d.format,d.texelType,d.data),this.unbind(0))},bind:function(a){var b=this.gl;b.activeTexture(b["TEXTURE"+(void 0===a?0:a)]);b.bindTexture(b.TEXTURE_2D,this.texture);this.isBound=!0},unbind:function(){a.bindTexture(a.TEXTURE_2D,null)}}}function ca(a,b){b=
void 0===b?{}:b;var c=void 0===b.textures?[]:b.textures,d=[],e,f=null;b=c.length;a instanceof WebGL2RenderingContext?e=a.getParameter(a.MAX_COLOR_ATTACHMENTS):(f=a.getExtension("WEBGL_draw_buffers"),e=a.getParameter(f.MAX_COLOR_ATTACHMENTS_WEBGL));if(0<b&&b<e)if(b===c.length)for(var h=0;h<b;++h)a instanceof WebGL2RenderingContext?d.push({texture:c[h],attachPoint:a.COLOR_ATTACHMENT0+h}):d.push({texture:c[h],attachPoint:f["COLOR_ATTACHMENT"+h+"_WEBGL"]});else console.error("fbo.js::createFBOAttachmentFormat - the number of desired attachments doesn't match the number of textures passed in");
return{attachments:0<d.length?d:!1,maxAttachments:e,ext:null!==f?f:!1}}function Y(a,b){var c=void 0===b?{}:b;b=void 0===c.width?512:c.width;var d=void 0===c.height?512:c.height,e=void 0===c.initTexture?null:c.initTexture,f=void 0===c.depthTexture?!1:c.depthTexture,c=void 0===c.format?null:c.format,h=a.createFramebuffer(),g=[],m=[],l=null;null!==e?l=e:(null!==c&&!1===c.attachments&&(l=K(a,{width:b,height:d,floatingPoint:!0})),null===c&&(l=K(a,{width:b,height:d,floatingPoint:!0})));a.bindFramebuffer(a.FRAMEBUFFER,
h);if(null===c)a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,l.raw,0);else for(var e=c.attachments.length,D=0;D<e;++D){var p=c.attachments[D],P=p.texture,p=p.attachPoint;a.framebufferTexture2D(a.FRAMEBUFFER,p,a.TEXTURE_2D,P.raw,0);m.push(p);g.push(P)}f&&(b=ta(a,{width:b,height:d}),a.framebufferTexture2D(FRAMEBUFFER,a.DEPTH_ATTACHMENT,TEXTURE_2D,b,0));a:switch(a.checkFramebufferStatus(a.FRAMEBUFFER)){case a.FRAMEBUFFER_UNSUPPORTED:throw Error("gl-fbo: Framebuffer unsupported");
case a.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw Error("gl-fbo: Framebuffer incomplete attachment");case a.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw Error("gl-fbo: Framebuffer incomplete dimensions");case a.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw Error("gl-fbo: Framebuffer incomplete missing attachment");case a.FRAMEBUFFER_COMPLETE:break a;default:console.error("unknown error creating framebuffer")}a.bindFramebuffer(a.FRAMEBUFFER,null);return{gl:a,name:"FBO",drawTexture:l,fbo:h,attachmentPoints:m,
attachmentTextures:0<g.length?g:!1,ext:null!==c?c.ext:!1,numAttachments:g.length,getTexture:function(a){a=void 0===a?0:a;return!1!==g&&a<g.length?this.attachmentTextures[a]:l},bind:function(){a.bindFramebuffer(FRAMEBUFFER,h)},unbind:function(){a.bindFramebuffer(FRAMEBUFFER,null)},drawBuffers:function(b){b=this.ext;a instanceof WebGL2RenderingContext?a.drawBuffers(this.attachmentPoints):!1!==b&&b.drawBuffersWEBGL(this.attachmentPoints)},getColorAttachmentTexture:function(a){return this.attachmentTextures[void 0===
a?0:a]},bindTexture:function(a){this.drawTexture.bind(void 0===a?0:a)},bindAttachmentTextures:function(){for(var a=0;a<this.numAttachments;++a)this.attachmentTextures[a].bind(a)},resize:function(a,b){a=void 0===a?window.innerWidth:a;b=void 0===b?window.innerHeight:b;this.drawTexture.resize(a,b)},unbindTexture:function(){a.bindTexture(a.TEXTURE_2D,null)}}}function wa(a){function b(a,b){var f=e[a];e[a]=c.length;c.push(c[f]);d.push(d[f]);k.push(b)}a=void 0===a?2:a;for(var c=[[-B,1,0],[B,1,0],[-B,-1,
0],[B,-1,0],[0,-B,1],[0,B,1],[0,-B,-1],[0,B,-1],[1,0,-B],[1,0,B],[-1,0,-B],[-1,0,B]],d=[[-B,1,0],[B,1,0],[-B,-1,0],[B,-1,0],[0,-B,1],[0,B,1],[0,-B,-1],[0,B,-1],[1,0,-B],[1,0,B],[-1,0,-B],[-1,0,B]],e=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,5,11,4,1,5,9,7,1,8,10,7,6,11,10,2,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],f=0;f<a;++f)for(var h=e.length/3,g=0;g<h;++g){var m=e[3*g+0],l=e[3*g+1],D=e[3*g+2],p=c.length,P=p+1,u=P+1;e[3*g+1]=p;e[3*g+2]=u;e[3*g+1]=p;e[3*g+2]=u;e.push(p);e.push(l);
e.push(P);e.push(u);e.push(p);e.push(P);e.push(u);e.push(P);e.push(D);c.push(z(v(c[m],c[l]),.5));c.push(z(v(c[l],c[D]),.5));c.push(z(v(c[D],c[m]),.5));d.push(z(v(d[m],d[l]),.5));d.push(z(v(d[l],d[D]),.5));d.push(z(v(d[D],d[m]),.5))}for(var k=Array(d.length).fill(0).map(function(){return[0,0]}),c=c.map(function(a){return F(a)}),d=d.map(function(a){return F(a)}),g=0;g<d.length;++g)a=d[g],k[g][0]=.5-.5*Math.atan(a[0],-a[2])/M_PI,k[g][1]=1-Math.acos(a[1])/M_PI;a=e.length/3;for(g=0;g<a;++g)f=k[e[3*g+0]],
h=k[e[3*g+1]],m=k[e[3*g+2]],l=h[0]-f[0],D=m[0]-f[0],.5<Math.abs(l)&&.5<Math.abs(D)?b(3*g+0,v(f,[0<l?1:-1,0])):.5<Math.abs(l)?b(3*g+1,v(h,[0>l?1:-1,0])):.5<Math.abs(D)&&b(3*g+2,v(m,[0>D?1:-1,0]));return{vertices:c,normals:d,uvs:k,indices:e,numVertices:c.length,numIndices:e.length}}function xa(a,b,c){a=new THREE.CylinderGeometry(1,1,1,void 0===a?8:a,void 0===b?50:b,void 0===c?!1:c);a.rotateZ(Math.PI/2);var d=new THREE.Vector2,e=[],f=[],h=[],g=a.vertices,m=a.faceVertexUvs[0];a.faces.forEach(function(a,
b){var c=m[b];[g[a.a],g[a.b],g[a.c]].forEach(function(a,b){d.set(a.y,a.z).normalize();f.push(Math.atan2(d.y,d.x));e.push(a.x);h.push(c[b].toArray())})});a=new Float32Array(e);new Float32Array(f);b=new Float32Array(2*h.length);for(c=0;c<a.length;c++){var l=$jscomp.makeIterator(h[c]),D=l.next().value,l=l.next().value;b[2*c+0]=D;b[2*c+1]=l}new THREE.BufferAttribute(a,1);return{positions:a,angles:f,uvs:b}}function da(){requestAnimationFrame(da);ea.draw()}window.jraDebug=!1;window.toggleDebug=function(){window.jraDebug=
!window.jraDebug};var fa=function(a,b){this.viewportY=this.viewportX=0;this.clear_color=[0,0,0,1];this.width=a;this.height=b};fa.prototype={attachToScreen:function(a){a=void 0===a?document.body:a;a.appendChild(this.canvas);return this},anchorToScreen:function(a){a=void 0===a?document.body:a;this.attachToScreen(a)},enableBlending:function(){this.enable(this.BLEND)},setBlendFunction:function(a,b){this.blendFunc(this[a],this[b])},enableAlphaBlending:function(){this.enable(this.BLEND);this.setBlendFunction("SRC_ALPHA",
"ONE")},testAdditive:function(){this.enable(this.BLEND);this.blendFunc(this.ONE,this.ONE)},enableAdditiveBlending:function(){this.enable(this.BLEND);this.blendEquationSeparate(this.FUNC_ADD,this.FUNC_ADD);this.blendFuncSeparate(this.ONE,this.ONE,this.ONE,this.ONE)},setSize:function(a,b){a=void 0===a?window.innerWidth:a;b=void 0===b?window.innerHeight:b;this.canvas.width=a;this.canvas.height=b;return this},blendLayers:function(){this.setBlendFunction("ONE","ONE_MINUS_SRC_ALPHA")},disableBlending:function(){this.disable(this.BLEND)},
enableInstancedAttribute:function(a,b){b=void 0===b?1:b;this.isWebGL2?this.vertexAttribDivisor(a,b):this.hasOwnProperty("ANGLE_instanced_arrays")?this.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(a,b):console.warn("Current GPU does not support the ANGLE_instance_arrays extension");return this},disableInstancedAttribute:function(a){this.isWebGL2?this.vertexAttribDivisor(a,0):this.hasOwnProperty("ANGLE_instance_arrays")?this.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(a,0):console.warn("Current GPU does not support the ANGLE_instance_arrays extension")},
drawInstancedArrays:function(a,b,c,d){this.isWebGL2?this.drawArraysInstanced(a,b,c,d):this.hasOwnProperty("ANGLE_instanced_arrays")?this.ANGLE_instanced_arrays.drawArraysInstancedANGLE(a,b,c,d):console.error("Unable to draw instanced geometry - extension is not available")},drawInstancedElements:function(a,b,c,d){var e=void 0===d?{}:d;d=void 0===e.type?UNSIGNED_SHORT:e.type;e=void 0===e.offset?0:e.offset;this.isWebGL2?this.drawElementsInstanced(a,b,d,e,c):this.hasOwnProperty("ANGLE_instanced_arrays")?
this.ANGLE_instanced_arrays.drawElementsInstancedANGLE(a,b,d,e,c):console.error("Unable to draw instanced geometry - extension is not available")},setFullscreen:function(a){a=void 0===a?null:a;var b=this;this.canvas.width=window.innerWidth;this.canvas.height=window.innerHeight;this.setViewport();a?window.addEventListener("resize",a):window.addEventListener("resize",function(){b.canvas.width=window.innerWidth;b.canvas.height=window.innerHeight;b.setViewport()});return this},clearScreen:function(a,
b,c,d){this.clearColor(void 0===a?0:a,void 0===b?0:b,void 0===c?0:c,void 0===d?1:d);this.viewport(this.viewportX,this.viewportY,this.canvas.width,this.canvas.height);this.clear(this.COLOR_BUFFER_BIT|this.DEPTH_BUFFER_BIT);return this},clearTextures:function(){this.bindTexture(this.TEXTURE_2D,null)},clearTransparent:function(a,b,c,d){this.clearColor(void 0===a?0:a,void 0===b?0:b,void 0===c?0:c,void 0===d?0:d);this.viewport(this.viewportX,this.viewportY,this.canvas.width,this.canvas.height);this.clear(this.COLOR_BUFFER_BIT);
return this},setClearColor:function(a,b,c,d){this.clearColor(void 0===a?0:a,void 0===b?0:b,void 0===c?0:c,void 0===d?1:d)},enableDepth:function(){this.enable(this.DEPTH_TEST);return this},disableDepth:function(){this.disable(this.DEPTH_TEST)},getMaxTextureSize:function(){return this.getParameter(this.gl.MAX_TEXTURE_SIZE)},setViewport:function(a,b,c,d){c=void 0===c?window.innerWidth:c;d=void 0===d?window.innerHeight:d;this.viewport(void 0===a?0:a,void 0===b?0:b,c,d)},applyCameraUniforms:function(a,
b,c){var d=void 0===c?{}:c;c=void 0===d.projection?"projection":d.projection;d=void 0===d.view?"view":d.view;a.set4x4Uniform(c,b.projection);a.set4x4Uniform(d,b.view)}};var q={EPSILON:.000001};q.ARRAY_TYPE="undefined"!==typeof Float32Array?Float32Array:Array;q.RANDOM=Math.random;q.ENABLE_SIMD=!1;q.SIMD_AVAILABLE=q.ARRAY_TYPE===window.Float32Array&&"SIMD"in window;q.USE_SIMD=q.ENABLE_SIMD&&q.SIMD_AVAILABLE;q.setMatrixArrayType=function(a){q.ARRAY_TYPE=a};var ya=Math.PI/180;q.toRadian=function(a){return a*
ya};q.equals=function(a,b){return Math.abs(a-b)<=q.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};var k={scalar:{},SIMD:{},create:function(){var a=new q.ARRAY_TYPE(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},clone:function(a){var b=new q.ARRAY_TYPE(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=
a[15];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},fromValues:function(a,b,c,d,e,f,h,g,m,l,D,p,k,u,n,J){var t=new q.ARRAY_TYPE(16);t[0]=a;t[1]=b;t[2]=c;t[3]=d;t[4]=e;t[5]=f;t[6]=h;t[7]=g;t[8]=m;t[9]=l;t[10]=D;t[11]=p;t[12]=k;t[13]=u;t[14]=n;t[15]=J;return t},set:function(a,b,c,d,e,f,h,g,m,l,D,p,k,u,n,J,t){a[0]=b;a[1]=c;a[2]=d;a[3]=e;
a[4]=f;a[5]=h;a[6]=g;a[7]=m;a[8]=l;a[9]=D;a[10]=p;a[11]=k;a[12]=u;a[13]=n;a[14]=J;a[15]=t;return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}};k.scalar.transpose=function(a,b){if(a===b){var c=b[1],d=b[2],e=b[3],f=b[6],h=b[7],g=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=c;a[6]=b[9];a[7]=b[13];a[8]=d;a[9]=f;a[11]=b[14];a[12]=e;a[13]=h;a[14]=g}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],
a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a};k.SIMD.transpose=function(a,b){var c,d,e,f,h,g;c=SIMD.Float32x4.load(b,0);d=SIMD.Float32x4.load(b,4);e=SIMD.Float32x4.load(b,8);b=SIMD.Float32x4.load(b,12);f=SIMD.Float32x4.shuffle(c,d,0,1,4,5);h=SIMD.Float32x4.shuffle(e,b,0,1,4,5);g=SIMD.Float32x4.shuffle(f,h,0,2,4,6);f=SIMD.Float32x4.shuffle(f,h,1,3,5,7);SIMD.Float32x4.store(a,0,g);SIMD.Float32x4.store(a,4,f);f=SIMD.Float32x4.shuffle(c,
d,2,3,6,7);h=SIMD.Float32x4.shuffle(e,b,2,3,6,7);c=SIMD.Float32x4.shuffle(f,h,0,2,4,6);d=SIMD.Float32x4.shuffle(f,h,1,3,5,7);SIMD.Float32x4.store(a,8,c);SIMD.Float32x4.store(a,12,d);return a};k.transpose=q.USE_SIMD?k.SIMD.transpose:k.scalar.transpose;k.scalar.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],h=b[4],g=b[5],m=b[6],l=b[7],D=b[8],p=b[9],k=b[10],u=b[11],n=b[12],J=b[13],t=b[14];b=b[15];var q=c*g-d*h,r=c*m-e*h,y=c*l-f*h,w=d*m-e*g,C=d*l-f*g,v=e*l-f*m,x=D*J-p*n,z=D*t-k*n,E=D*b-u*n,I=p*
t-k*J,M=p*b-u*J,N=k*b-u*t,G=q*N-r*M+y*I+w*E-C*z+v*x;if(!G)return null;G=1/G;a[0]=(g*N-m*M+l*I)*G;a[1]=(e*M-d*N-f*I)*G;a[2]=(J*v-t*C+b*w)*G;a[3]=(k*C-p*v-u*w)*G;a[4]=(m*E-h*N-l*z)*G;a[5]=(c*N-e*E+f*z)*G;a[6]=(t*y-n*v-b*r)*G;a[7]=(D*v-k*y+u*r)*G;a[8]=(h*M-g*E+l*x)*G;a[9]=(d*E-c*M-f*x)*G;a[10]=(n*C-J*y+b*q)*G;a[11]=(p*y-D*C-u*q)*G;a[12]=(g*z-h*I-m*x)*G;a[13]=(c*I-d*z+e*x)*G;a[14]=(J*r-n*w-t*q)*G;a[15]=(D*w-p*r+k*q)*G;return a};k.SIMD.invert=function(a,b){var c,d,e,f,h,g,m,l;h=SIMD.Float32x4.load(b,0);
g=SIMD.Float32x4.load(b,4);m=SIMD.Float32x4.load(b,8);l=SIMD.Float32x4.load(b,12);b=SIMD.Float32x4.shuffle(h,g,0,1,4,5);d=SIMD.Float32x4.shuffle(m,l,0,1,4,5);c=SIMD.Float32x4.shuffle(b,d,0,2,4,6);d=SIMD.Float32x4.shuffle(d,b,1,3,5,7);b=SIMD.Float32x4.shuffle(h,g,2,3,6,7);f=SIMD.Float32x4.shuffle(m,l,2,3,6,7);e=SIMD.Float32x4.shuffle(b,f,0,2,4,6);f=SIMD.Float32x4.shuffle(f,b,1,3,5,7);b=SIMD.Float32x4.mul(e,f);b=SIMD.Float32x4.swizzle(b,1,0,3,2);h=SIMD.Float32x4.mul(d,b);g=SIMD.Float32x4.mul(c,b);b=
SIMD.Float32x4.swizzle(b,2,3,0,1);h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(d,b),h);g=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,b),g);g=SIMD.Float32x4.swizzle(g,2,3,0,1);b=SIMD.Float32x4.mul(d,e);b=SIMD.Float32x4.swizzle(b,1,0,3,2);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,b),h);l=SIMD.Float32x4.mul(c,b);b=SIMD.Float32x4.swizzle(b,2,3,0,1);h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(f,b));l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,b),l);l=SIMD.Float32x4.swizzle(l,2,3,0,1);b=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,
2,3,0,1),f);b=SIMD.Float32x4.swizzle(b,1,0,3,2);e=SIMD.Float32x4.swizzle(e,2,3,0,1);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,b),h);m=SIMD.Float32x4.mul(c,b);b=SIMD.Float32x4.swizzle(b,2,3,0,1);h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(e,b));m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,b),m);m=SIMD.Float32x4.swizzle(m,2,3,0,1);b=SIMD.Float32x4.mul(c,d);b=SIMD.Float32x4.swizzle(b,1,0,3,2);m=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,b),m);l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,b),l);b=SIMD.Float32x4.swizzle(b,
2,3,0,1);m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,b),m);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(e,b));b=SIMD.Float32x4.mul(c,f);b=SIMD.Float32x4.swizzle(b,1,0,3,2);g=SIMD.Float32x4.sub(g,SIMD.Float32x4.mul(e,b));m=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,b),m);b=SIMD.Float32x4.swizzle(b,2,3,0,1);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,b),g);m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(d,b));b=SIMD.Float32x4.mul(c,e);b=SIMD.Float32x4.swizzle(b,1,0,3,2);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,b),
g);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(d,b));b=SIMD.Float32x4.swizzle(b,2,3,0,1);g=SIMD.Float32x4.sub(g,SIMD.Float32x4.mul(f,b));l=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,b),l);c=SIMD.Float32x4.mul(c,h);c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,2,3,0,1),c);c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,1,0,3,2),c);b=SIMD.Float32x4.reciprocalApproximation(c);c=SIMD.Float32x4.sub(SIMD.Float32x4.add(b,b),SIMD.Float32x4.mul(c,SIMD.Float32x4.mul(b,b)));c=SIMD.Float32x4.swizzle(c,0,0,0,0);if(!c)return null;
SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(c,h));SIMD.Float32x4.store(a,4,SIMD.Float32x4.mul(c,g));SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(c,m));SIMD.Float32x4.store(a,12,SIMD.Float32x4.mul(c,l));return a};k.invert=q.USE_SIMD?k.SIMD.invert:k.scalar.invert;k.scalar.adjoint=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],h=b[4],g=b[5],m=b[6],l=b[7],D=b[8],p=b[9],k=b[10],u=b[11],n=b[12],q=b[13],t=b[14];b=b[15];a[0]=g*(k*b-u*t)-p*(m*b-l*t)+q*(m*u-l*k);a[1]=-(d*(k*b-u*t)-p*(e*b-f*t)+q*(e*u-f*k));a[2]=
d*(m*b-l*t)-g*(e*b-f*t)+q*(e*l-f*m);a[3]=-(d*(m*u-l*k)-g*(e*u-f*k)+p*(e*l-f*m));a[4]=-(h*(k*b-u*t)-D*(m*b-l*t)+n*(m*u-l*k));a[5]=c*(k*b-u*t)-D*(e*b-f*t)+n*(e*u-f*k);a[6]=-(c*(m*b-l*t)-h*(e*b-f*t)+n*(e*l-f*m));a[7]=c*(m*u-l*k)-h*(e*u-f*k)+D*(e*l-f*m);a[8]=h*(p*b-u*q)-D*(g*b-l*q)+n*(g*u-l*p);a[9]=-(c*(p*b-u*q)-D*(d*b-f*q)+n*(d*u-f*p));a[10]=c*(g*b-l*q)-h*(d*b-f*q)+n*(d*l-f*g);a[11]=-(c*(g*u-l*p)-h*(d*u-f*p)+D*(d*l-f*g));a[12]=-(h*(p*t-k*q)-D*(g*t-m*q)+n*(g*k-m*p));a[13]=c*(p*t-k*q)-D*(d*t-e*q)+n*(d*
k-e*p);a[14]=-(c*(g*t-m*q)-h*(d*t-e*q)+n*(d*m-e*g));a[15]=c*(g*k-m*p)-h*(d*k-e*p)+D*(d*m-e*g);return a};k.SIMD.adjoint=function(a,b){var c,d,e,f,h,g,m,l;c=SIMD.Float32x4.load(b,0);d=SIMD.Float32x4.load(b,4);e=SIMD.Float32x4.load(b,8);f=SIMD.Float32x4.load(b,12);g=SIMD.Float32x4.shuffle(c,d,0,1,4,5);h=SIMD.Float32x4.shuffle(e,f,0,1,4,5);b=SIMD.Float32x4.shuffle(g,h,0,2,4,6);h=SIMD.Float32x4.shuffle(h,g,1,3,5,7);g=SIMD.Float32x4.shuffle(c,d,2,3,6,7);d=SIMD.Float32x4.shuffle(e,f,2,3,6,7);c=SIMD.Float32x4.shuffle(g,
d,0,2,4,6);d=SIMD.Float32x4.shuffle(d,g,1,3,5,7);g=SIMD.Float32x4.mul(c,d);g=SIMD.Float32x4.swizzle(g,1,0,3,2);e=SIMD.Float32x4.mul(h,g);f=SIMD.Float32x4.mul(b,g);g=SIMD.Float32x4.swizzle(g,2,3,0,1);e=SIMD.Float32x4.sub(SIMD.Float32x4.mul(h,g),e);f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,g),f);f=SIMD.Float32x4.swizzle(f,2,3,0,1);g=SIMD.Float32x4.mul(h,c);g=SIMD.Float32x4.swizzle(g,1,0,3,2);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,g),e);l=SIMD.Float32x4.mul(b,g);g=SIMD.Float32x4.swizzle(g,2,3,0,1);
e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(d,g));l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,g),l);l=SIMD.Float32x4.swizzle(l,2,3,0,1);g=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,3,0,1),d);g=SIMD.Float32x4.swizzle(g,1,0,3,2);c=SIMD.Float32x4.swizzle(c,2,3,0,1);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,g),e);m=SIMD.Float32x4.mul(b,g);g=SIMD.Float32x4.swizzle(g,2,3,0,1);e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(c,g));m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,g),m);m=SIMD.Float32x4.swizzle(m,2,3,0,
1);g=SIMD.Float32x4.mul(b,h);g=SIMD.Float32x4.swizzle(g,1,0,3,2);m=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,g),m);l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,g),l);g=SIMD.Float32x4.swizzle(g,2,3,0,1);m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(d,g),m);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(c,g));g=SIMD.Float32x4.mul(b,d);g=SIMD.Float32x4.swizzle(g,1,0,3,2);f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(c,g));m=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,g),m);g=SIMD.Float32x4.swizzle(g,2,3,0,1);f=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,
g),f);m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(h,g));g=SIMD.Float32x4.mul(b,c);g=SIMD.Float32x4.swizzle(g,1,0,3,2);f=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,g),f);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(h,g));g=SIMD.Float32x4.swizzle(g,2,3,0,1);f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(d,g));l=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,g),l);SIMD.Float32x4.store(a,0,e);SIMD.Float32x4.store(a,4,f);SIMD.Float32x4.store(a,8,m);SIMD.Float32x4.store(a,12,l);return a};k.adjoint=q.USE_SIMD?k.SIMD.adjoint:
k.scalar.adjoint;k.determinant=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],h=a[5],g=a[6],m=a[7],l=a[8],k=a[9],p=a[10],q=a[11],u=a[12],n=a[13],r=a[14];a=a[15];return(b*h-c*f)*(p*a-q*r)-(b*g-d*f)*(k*a-q*n)+(b*m-e*f)*(k*r-p*n)+(c*g-d*h)*(l*a-q*u)-(c*m-e*h)*(l*r-p*u)+(d*m-e*g)*(l*n-k*u)};k.SIMD.multiply=function(a,b,c){var d=SIMD.Float32x4.load(b,0),e=SIMD.Float32x4.load(b,4),f=SIMD.Float32x4.load(b,8);b=SIMD.Float32x4.load(b,12);var h=SIMD.Float32x4.load(c,0),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,
0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),f),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),b))));SIMD.Float32x4.store(a,0,h);h=SIMD.Float32x4.load(c,4);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),f),
SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),b))));SIMD.Float32x4.store(a,4,h);h=SIMD.Float32x4.load(c,8);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),f),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),b))));SIMD.Float32x4.store(a,8,h);c=SIMD.Float32x4.load(c,12);d=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,
0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),f),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),b))));SIMD.Float32x4.store(a,12,d);return a};k.scalar.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],h=b[3],g=b[4],m=b[5],l=b[6],k=b[7],p=b[8],q=b[9],u=b[10],n=b[11],r=b[12],t=b[13],y=b[14];b=b[15];var w=c[0],v=c[1],x=c[2],C=c[3];a[0]=w*d+v*g+x*p+C*r;a[1]=w*e+v*m+x*q+C*t;a[2]=w*f+v*
l+x*u+C*y;a[3]=w*h+v*k+x*n+C*b;w=c[4];v=c[5];x=c[6];C=c[7];a[4]=w*d+v*g+x*p+C*r;a[5]=w*e+v*m+x*q+C*t;a[6]=w*f+v*l+x*u+C*y;a[7]=w*h+v*k+x*n+C*b;w=c[8];v=c[9];x=c[10];C=c[11];a[8]=w*d+v*g+x*p+C*r;a[9]=w*e+v*m+x*q+C*t;a[10]=w*f+v*l+x*u+C*y;a[11]=w*h+v*k+x*n+C*b;w=c[12];v=c[13];x=c[14];C=c[15];a[12]=w*d+v*g+x*p+C*r;a[13]=w*e+v*m+x*q+C*t;a[14]=w*f+v*l+x*u+C*y;a[15]=w*h+v*k+x*n+C*b;return a};k.multiply=q.USE_SIMD?k.SIMD.multiply:k.scalar.multiply;k.mul=k.multiply;k.scalar.translate=function(a,b,c){var d=
c[0],e=c[1];c=c[2];var f,h,g,m,l,k,p,q,u,n,r,t;b===a?(a[12]=b[0]*d+b[4]*e+b[8]*c+b[12],a[13]=b[1]*d+b[5]*e+b[9]*c+b[13],a[14]=b[2]*d+b[6]*e+b[10]*c+b[14],a[15]=b[3]*d+b[7]*e+b[11]*c+b[15]):(f=b[0],h=b[1],g=b[2],m=b[3],l=b[4],k=b[5],p=b[6],q=b[7],u=b[8],n=b[9],r=b[10],t=b[11],a[0]=f,a[1]=h,a[2]=g,a[3]=m,a[4]=l,a[5]=k,a[6]=p,a[7]=q,a[8]=u,a[9]=n,a[10]=r,a[11]=t,a[12]=f*d+l*e+u*c+b[12],a[13]=h*d+k*e+n*c+b[13],a[14]=g*d+p*e+r*c+b[14],a[15]=m*d+q*e+t*c+b[15]);return a};k.SIMD.translate=function(a,b,c){var d=
SIMD.Float32x4.load(b,0),e=SIMD.Float32x4.load(b,4),f=SIMD.Float32x4.load(b,8),h=SIMD.Float32x4.load(b,12);c=SIMD.Float32x4(c[0],c[1],c[2],0);b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11]);d=SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,0,0,0,0));e=SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(c,1,1,1,1));f=SIMD.Float32x4.mul(f,SIMD.Float32x4.swizzle(c,2,2,2,2));b=SIMD.Float32x4.add(d,SIMD.Float32x4.add(e,SIMD.Float32x4.add(f,
h)));SIMD.Float32x4.store(a,12,b);return a};k.translate=q.USE_SIMD?k.SIMD.translate:k.scalar.translate;k.scalar.scale=function(a,b,c){var d=c[0],e=c[1];c=c[2];a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;a[4]=b[4]*e;a[5]=b[5]*e;a[6]=b[6]*e;a[7]=b[7]*e;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};k.SIMD.scale=function(a,b,c){var d;c=SIMD.Float32x4(c[0],c[1],c[2],0);d=SIMD.Float32x4.load(b,0);SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(d,
SIMD.Float32x4.swizzle(c,0,0,0,0)));d=SIMD.Float32x4.load(b,4);SIMD.Float32x4.store(a,4,SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,1,1,1,1)));d=SIMD.Float32x4.load(b,8);SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,2,2,2,2)));a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};k.scale=q.USE_SIMD?k.SIMD.scale:k.scalar.scale;k.rotate=function(a,b,c,d){var e=d[0],f=d[1];d=d[2];var h=Math.sqrt(e*e+f*f+d*d),g,m,l,k,p,n,u,r,w,t,v,x,y,z,C,A,B,L,E,I;if(Math.abs(h)<q.EPSILON)return null;
h=1/h;e*=h;f*=h;d*=h;g=Math.sin(c);m=Math.cos(c);l=1-m;c=b[0];h=b[1];k=b[2];p=b[3];n=b[4];u=b[5];r=b[6];w=b[7];t=b[8];v=b[9];x=b[10];y=b[11];z=e*e*l+m;C=f*e*l+d*g;A=d*e*l-f*g;B=e*f*l-d*g;L=f*f*l+m;E=d*f*l+e*g;I=e*d*l+f*g;e=f*d*l-e*g;f=d*d*l+m;a[0]=c*z+n*C+t*A;a[1]=h*z+u*C+v*A;a[2]=k*z+r*C+x*A;a[3]=p*z+w*C+y*A;a[4]=c*B+n*L+t*E;a[5]=h*B+u*L+v*E;a[6]=k*B+r*L+x*E;a[7]=p*B+w*L+y*E;a[8]=c*I+n*e+t*f;a[9]=h*I+u*e+v*f;a[10]=k*I+r*e+x*f;a[11]=p*I+w*e+y*f;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);
return a};k.scalar.rotateX=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[4],f=b[5],h=b[6],g=b[7],m=b[8],l=b[9],k=b[10],p=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=e*c+m*d;a[5]=f*c+l*d;a[6]=h*c+k*d;a[7]=g*c+p*d;a[8]=m*c-e*d;a[9]=l*c-f*d;a[10]=k*c-h*d;a[11]=p*c-g*d;return a};k.SIMD.rotateX=function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],
a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);var e=SIMD.Float32x4.load(b,4);b=SIMD.Float32x4.load(b,8);SIMD.Float32x4.store(a,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(e,c),SIMD.Float32x4.mul(b,d)));SIMD.Float32x4.store(a,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,c),SIMD.Float32x4.mul(e,d)));return a};k.rotateX=q.USE_SIMD?k.SIMD.rotateX:k.scalar.rotateX;k.scalar.rotateY=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[0],f=b[1],h=b[2],g=b[3],m=b[8],l=b[9],k=b[10],p=b[11];b!==a&&(a[4]=b[4],
a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*c-m*d;a[1]=f*c-l*d;a[2]=h*c-k*d;a[3]=g*c-p*d;a[8]=e*d+m*c;a[9]=f*d+l*c;a[10]=h*d+k*c;a[11]=g*d+p*c;return a};k.SIMD.rotateY=function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);var e=SIMD.Float32x4.load(b,0);b=SIMD.Float32x4.load(b,8);SIMD.Float32x4.store(a,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,
c),SIMD.Float32x4.mul(b,d)));SIMD.Float32x4.store(a,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(e,d),SIMD.Float32x4.mul(b,c)));return a};k.rotateY=q.USE_SIMD?k.SIMD.rotateY:k.scalar.rotateY;k.scalar.rotateZ=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[0],f=b[1],h=b[2],g=b[3],m=b[4],l=b[5],k=b[6],p=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*c+m*d;a[1]=f*c+l*d;a[2]=h*c+k*d;a[3]=g*c+p*d;a[4]=m*c-e*d;a[5]=l*c-f*d;a[6]=k*c-h*
d;a[7]=p*c-g*d;return a};k.SIMD.rotateZ=function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);var e=SIMD.Float32x4.load(b,0);b=SIMD.Float32x4.load(b,4);SIMD.Float32x4.store(a,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(e,c),SIMD.Float32x4.mul(b,d)));SIMD.Float32x4.store(a,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,c),SIMD.Float32x4.mul(e,d)));return a};k.rotateZ=q.USE_SIMD?
k.SIMD.rotateZ:k.scalar.rotateZ;k.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=b[0];a[13]=b[1];a[14]=b[2];a[15]=1;return a};k.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b[1];a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=b[2];a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};k.fromRotation=function(a,b,c){var d=c[0],e=c[1];c=c[2];var f=Math.sqrt(d*d+e*e+c*c),h;if(Math.abs(f)<q.EPSILON)return null;f=1/f;d*=f;
e*=f;c*=f;f=Math.sin(b);b=Math.cos(b);h=1-b;a[0]=d*d*h+b;a[1]=e*d*h+c*f;a[2]=c*d*h-e*f;a[3]=0;a[4]=d*e*h-c*f;a[5]=e*e*h+b;a[6]=c*e*h+d*f;a[7]=0;a[8]=d*c*h+e*f;a[9]=e*c*h-d*f;a[10]=c*c*h+b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};k.fromXRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=c;a[7]=0;a[8]=0;a[9]=-c;a[10]=b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};k.fromYRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=
0;a[2]=-c;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=c;a[9]=0;a[10]=b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};k.fromZRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=c;a[2]=0;a[3]=0;a[4]=-c;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};k.fromRotationTranslation=function(a,b,c){var d=b[0],e=b[1],f=b[2],h=b[3],g=d+d,m=e+e,l=f+f;b=d*g;var k=d*m,d=d*l,p=e*m,e=e*l,f=f*l,g=h*g,m=h*m,h=h*l;a[0]=1-(p+f);a[1]=k+h;a[2]=d-m;a[3]=0;a[4]=
k-h;a[5]=1-(b+f);a[6]=e+g;a[7]=0;a[8]=d+m;a[9]=e-g;a[10]=1-(b+p);a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a};k.getTranslation=function(a,b){a[0]=b[12];a[1]=b[13];a[2]=b[14];return a};k.getRotation=function(a,b){var c=b[0]+b[5]+b[10];0<c?(c=2*Math.sqrt(c+1),a[3]=.25*c,a[0]=(b[6]-b[9])/c,a[1]=(b[8]-b[2])/c,a[2]=(b[1]-b[4])/c):b[0]>b[5]&b[0]>b[10]?(c=2*Math.sqrt(1+b[0]-b[5]-b[10]),a[3]=(b[6]-b[9])/c,a[0]=.25*c,a[1]=(b[1]+b[4])/c,a[2]=(b[8]+b[2])/c):b[5]>b[10]?(c=2*Math.sqrt(1+b[5]-b[0]-
b[10]),a[3]=(b[8]-b[2])/c,a[0]=(b[1]+b[4])/c,a[1]=.25*c,a[2]=(b[6]+b[9])/c):(c=2*Math.sqrt(1+b[10]-b[0]-b[5]),a[3]=(b[1]-b[4])/c,a[0]=(b[8]+b[2])/c,a[1]=(b[6]+b[9])/c,a[2]=.25*c);return a};k.fromRotationTranslationScale=function(a,b,c,d){var e=b[0],f=b[1],h=b[2],g=b[3],m=e+e,l=f+f,k=h+h;b=e*m;var p=e*l,e=e*k,n=f*l,f=f*k,h=h*k,m=g*m,l=g*l,g=g*k,k=d[0],u=d[1];d=d[2];a[0]=(1-(n+h))*k;a[1]=(p+g)*k;a[2]=(e-l)*k;a[3]=0;a[4]=(p-g)*u;a[5]=(1-(b+h))*u;a[6]=(f+m)*u;a[7]=0;a[8]=(e+l)*d;a[9]=(f-m)*d;a[10]=(1-
(b+n))*d;a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a};k.fromRotationTranslationScaleOrigin=function(a,b,c,d,e){var f=b[0],h=b[1],g=b[2],m=b[3],l=f+f,k=h+h,p=g+g;b=f*l;var n=f*k,f=f*p,u=h*k,h=h*p,g=g*p,l=m*l,k=m*k,m=m*p,p=d[0],q=d[1];d=d[2];var r=e[0],t=e[1];e=e[2];a[0]=(1-(u+g))*p;a[1]=(n+m)*p;a[2]=(f-k)*p;a[3]=0;a[4]=(n-m)*q;a[5]=(1-(b+g))*q;a[6]=(h+l)*q;a[7]=0;a[8]=(f+k)*d;a[9]=(h-l)*d;a[10]=(1-(b+u))*d;a[11]=0;a[12]=c[0]+r-(a[0]*r+a[4]*t+a[8]*e);a[13]=c[1]+t-(a[1]*r+a[5]*t+a[9]*e);
a[14]=c[2]+e-(a[2]*r+a[6]*t+a[10]*e);a[15]=1;return a};k.fromQuat=function(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];var f=c+c,h=d+d,g=e+e,c=c*f,m=d*f,d=d*h,l=e*f,k=e*h,e=e*g,f=b*f,h=b*h;b*=g;a[0]=1-d-e;a[1]=m+b;a[2]=l-h;a[3]=0;a[4]=m-b;a[5]=1-c-e;a[6]=k+f;a[7]=0;a[8]=l+h;a[9]=k-f;a[10]=1-c-d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};k.frustum=function(a,b,c,d,e,f,h){var g=1/(c-b),m=1/(e-d),l=1/(f-h);a[0]=2*f*g;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*f*m;a[6]=0;a[7]=0;a[8]=(c+b)*g;a[9]=(e+d)*m;a[10]=
(h+f)*l;a[11]=-1;a[12]=0;a[13]=0;a[14]=h*f*2*l;a[15]=0;return a};k.perspective=function(a,b,c,d,e){b=1/Math.tan(b/2);var f=1/(d-e);a[0]=b/c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(e+d)*f;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*e*d*f;a[15]=0;return a};k.perspectiveFromFieldOfView=function(a,b,c,d){var e=Math.tan(b.upDegrees*Math.PI/180),f=Math.tan(b.downDegrees*Math.PI/180),h=Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*Math.PI/180);var g=2/(h+b),m=2/(e+f);a[0]=
g;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=m;a[6]=0;a[7]=0;a[8]=-((h-b)*g*.5);a[9]=(e-f)*m*.5;a[10]=d/(c-d);a[11]=-1;a[12]=0;a[13]=0;a[14]=d*c/(c-d);a[15]=0;return a};k.ortho=function(a,b,c,d,e,f,h){var g=1/(b-c),m=1/(d-e),l=1/(f-h);a[0]=-2*g;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*m;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*l;a[11]=0;a[12]=(b+c)*g;a[13]=(e+d)*m;a[14]=(h+f)*l;a[15]=1;return a};k.lookAt=function(a,b,c,d){var e,f,h,g,m,l,n,p,r=b[0],u=b[1];b=b[2];h=d[0];g=d[1];f=d[2];n=c[0];d=c[1];e=c[2];if(Math.abs(r-
n)<q.EPSILON&&Math.abs(u-d)<q.EPSILON&&Math.abs(b-e)<q.EPSILON)return k.identity(a);c=r-n;d=u-d;n=b-e;p=1/Math.sqrt(c*c+d*d+n*n);c*=p;d*=p;n*=p;e=g*n-f*d;f=f*c-h*n;h=h*d-g*c;(p=Math.sqrt(e*e+f*f+h*h))?(p=1/p,e*=p,f*=p,h*=p):h=f=e=0;g=d*h-n*f;m=n*e-c*h;l=c*f-d*e;(p=Math.sqrt(g*g+m*m+l*l))?(p=1/p,g*=p,m*=p,l*=p):l=m=g=0;a[0]=e;a[1]=g;a[2]=c;a[3]=0;a[4]=f;a[5]=m;a[6]=d;a[7]=0;a[8]=h;a[9]=l;a[10]=n;a[11]=0;a[12]=-(e*r+f*u+h*b);a[13]=-(g*r+m*u+l*b);a[14]=-(c*r+d*u+n*b);a[15]=1;return a};k.str=function(a){return"mat4("+
a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};k.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};k.add=function(a,b,
c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];a[6]=b[6]+c[6];a[7]=b[7]+c[7];a[8]=b[8]+c[8];a[9]=b[9]+c[9];a[10]=b[10]+c[10];a[11]=b[11]+c[11];a[12]=b[12]+c[12];a[13]=b[13]+c[13];a[14]=b[14]+c[14];a[15]=b[15]+c[15];return a};k.subtract=function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];a[4]=b[4]-c[4];a[5]=b[5]-c[5];a[6]=b[6]-c[6];a[7]=b[7]-c[7];a[8]=b[8]-c[8];a[9]=b[9]-c[9];a[10]=b[10]-c[10];a[11]=b[11]-c[11];a[12]=b[12]-c[12];
a[13]=b[13]-c[13];a[14]=b[14]-c[14];a[15]=b[15]-c[15];return a};k.sub=k.subtract;k.multiplyScalar=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;a[6]=b[6]*c;a[7]=b[7]*c;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12]*c;a[13]=b[13]*c;a[14]=b[14]*c;a[15]=b[15]*c;return a};k.multiplyScalarAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;a[3]=b[3]+c[3]*d;a[4]=b[4]+c[4]*d;a[5]=b[5]+c[5]*d;a[6]=b[6]+c[6]*d;a[7]=b[7]+c[7]*
d;a[8]=b[8]+c[8]*d;a[9]=b[9]+c[9]*d;a[10]=b[10]+c[10]*d;a[11]=b[11]+c[11]*d;a[12]=b[12]+c[12]*d;a[13]=b[13]+c[13]*d;a[14]=b[14]+c[14]*d;a[15]=b[15]+c[15]*d;return a};k.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]&&a[9]===b[9]&&a[10]===b[10]&&a[11]===b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]};k.equals=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],h=a[4],g=a[5],m=a[6],l=a[7],
k=a[8],p=a[9],n=a[10],u=a[11],r=a[12],w=a[13],t=a[14];a=a[15];var v=b[0],x=b[1],y=b[2],z=b[3],C=b[4],A=b[5],B=b[6],L=b[7],E=b[8],I=b[9],M=b[10],N=b[11],G=b[12],F=b[13],H=b[14];b=b[15];return Math.abs(c-v)<=q.EPSILON*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(d-x)<=q.EPSILON*Math.max(1,Math.abs(d),Math.abs(x))&&Math.abs(e-y)<=q.EPSILON*Math.max(1,Math.abs(e),Math.abs(y))&&Math.abs(f-z)<=q.EPSILON*Math.max(1,Math.abs(f),Math.abs(z))&&Math.abs(h-C)<=q.EPSILON*Math.max(1,Math.abs(h),Math.abs(C))&&
Math.abs(g-A)<=q.EPSILON*Math.max(1,Math.abs(g),Math.abs(A))&&Math.abs(m-B)<=q.EPSILON*Math.max(1,Math.abs(m),Math.abs(B))&&Math.abs(l-L)<=q.EPSILON*Math.max(1,Math.abs(l),Math.abs(L))&&Math.abs(k-E)<=q.EPSILON*Math.max(1,Math.abs(k),Math.abs(E))&&Math.abs(p-I)<=q.EPSILON*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(n-M)<=q.EPSILON*Math.max(1,Math.abs(n),Math.abs(M))&&Math.abs(u-N)<=q.EPSILON*Math.max(1,Math.abs(u),Math.abs(N))&&Math.abs(r-G)<=q.EPSILON*Math.max(1,Math.abs(r),Math.abs(G))&&Math.abs(w-
F)<=q.EPSILON*Math.max(1,Math.abs(w),Math.abs(F))&&Math.abs(t-H)<=q.EPSILON*Math.max(1,Math.abs(t),Math.abs(H))&&Math.abs(a-b)<=q.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};var n={create:function(){var a=new q.ARRAY_TYPE(3);a[0]=0;a[1]=0;a[2]=0;return a},clone:function(a){var b=new q.ARRAY_TYPE(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},fromValues:function(a,b,c){var d=new q.ARRAY_TYPE(3);d[0]=a;d[1]=b;d[2]=c;return d},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];return a},set:function(a,b,
c,d){a[0]=b;a[1]=c;a[2]=d;return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];return a},subtract:function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];return a}};n.sub=n.subtract;n.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];a[2]=b[2]*c[2];return a};n.mul=n.multiply;n.divide=function(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];return a};n.div=n.divide;n.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);a[2]=Math.ceil(b[2]);return a};n.floor=
function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);a[2]=Math.floor(b[2]);return a};n.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);return a};n.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);return a};n.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);a[2]=Math.round(b[2]);return a};n.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;return a};n.scaleAndAdd=function(a,b,c,
d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;return a};n.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];a=b[2]-a[2];return Math.sqrt(c*c+d*d+a*a)};n.dist=n.distance;n.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];a=b[2]-a[2];return c*c+d*d+a*a};n.sqrDist=n.squaredDistance;n.length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};n.len=n.length;n.squaredLength=function(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a};n.sqrLen=n.squaredLength;n.negate=function(a,
b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];return a};n.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];a[2]=1/b[2];return a};n.normalize=function(a,b){var c=b[0],d=b[1],e=b[2],c=c*c+d*d+e*e;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c);return a};n.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};n.cross=function(a,b,c){var d=b[0],e=b[1];b=b[2];var f=c[0],h=c[1];c=c[2];a[0]=e*c-b*h;a[1]=b*f-d*c;a[2]=d*h-e*f;return a};n.lerp=function(a,b,c,d){var e=b[0],f=b[1];b=b[2];a[0]=e+d*(c[0]-e);a[1]=
f+d*(c[1]-f);a[2]=b+d*(c[2]-b);return a};n.hermite=function(a,b,c,d,e,f){var h=f*f,g=h*(2*f-3)+1,m=h*(f-2)+f,l=h*(f-1);f=h*(3-2*f);a[0]=b[0]*g+c[0]*m+d[0]*l+e[0]*f;a[1]=b[1]*g+c[1]*m+d[1]*l+e[1]*f;a[2]=b[2]*g+c[2]*m+d[2]*l+e[2]*f;return a};n.bezier=function(a,b,c,d,e,f){var h=1-f,g=h*h,m=f*f,l=g*h,g=3*f*g,h=3*m*h;f*=m;a[0]=b[0]*l+c[0]*g+d[0]*h+e[0]*f;a[1]=b[1]*l+c[1]*g+d[1]*h+e[1]*f;a[2]=b[2]*l+c[2]*g+d[2]*h+e[2]*f;return a};n.random=function(a,b){b=b||1;var c=2*q.RANDOM()*Math.PI,d=2*q.RANDOM()-
1,e=Math.sqrt(1-d*d)*b;a[0]=Math.cos(c)*e;a[1]=Math.sin(c)*e;a[2]=d*b;return a};n.transformMat4=function(a,b,c){var d=b[0],e=b[1];b=b[2];var f=c[3]*d+c[7]*e+c[11]*b+c[15],f=f||1;a[0]=(c[0]*d+c[4]*e+c[8]*b+c[12])/f;a[1]=(c[1]*d+c[5]*e+c[9]*b+c[13])/f;a[2]=(c[2]*d+c[6]*e+c[10]*b+c[14])/f;return a};n.transformMat3=function(a,b,c){var d=b[0],e=b[1];b=b[2];a[0]=d*c[0]+e*c[3]+b*c[6];a[1]=d*c[1]+e*c[4]+b*c[7];a[2]=d*c[2]+e*c[5]+b*c[8];return a};n.transformQuat=function(a,b,c){var d=b[0],e=b[1],f=b[2];b=
c[0];var h=c[1],g=c[2];c=c[3];var m=c*d+h*f-g*e,l=c*e+g*d-b*f,k=c*f+b*e-h*d,d=-b*d-h*e-g*f;a[0]=m*c+d*-b+l*-g-k*-h;a[1]=l*c+d*-h+k*-b-m*-g;a[2]=k*c+d*-g+m*-h-l*-b;return a};n.rotateX=function(a,b,c,d){var e=[],f=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];f[0]=e[0];f[1]=e[1]*Math.cos(d)-e[2]*Math.sin(d);f[2]=e[1]*Math.sin(d)+e[2]*Math.cos(d);a[0]=f[0]+c[0];a[1]=f[1]+c[1];a[2]=f[2]+c[2];return a};n.rotateY=function(a,b,c,d){var e=[],f=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];f[0]=e[2]*Math.sin(d)+
e[0]*Math.cos(d);f[1]=e[1];f[2]=e[2]*Math.cos(d)-e[0]*Math.sin(d);a[0]=f[0]+c[0];a[1]=f[1]+c[1];a[2]=f[2]+c[2];return a};n.rotateZ=function(a,b,c,d){var e=[],f=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];f[0]=e[0]*Math.cos(d)-e[1]*Math.sin(d);f[1]=e[0]*Math.sin(d)+e[1]*Math.cos(d);f[2]=e[2];a[0]=f[0]+c[0];a[1]=f[1]+c[1];a[2]=f[2]+c[2];return a};n.forEach=function(){var a=n.create();return function(b,c,d,e,f,h){c||(c=3);d||(d=0);for(e=e?Math.min(e*c+d,b.length):b.length;d<e;d+=c)a[0]=b[d],a[1]=
b[d+1],a[2]=b[d+2],f(a,a,h),b[d]=a[0],b[d+1]=a[1],b[d+2]=a[2];return b}}();n.angle=function(a,b){a=n.fromValues(a[0],a[1],a[2]);b=n.fromValues(b[0],b[1],b[2]);n.normalize(a,a);n.normalize(b,b);b=n.dot(a,b);return 1<b?0:Math.acos(b)};n.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};n.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]};n.equals=function(a,b){var c=a[0],d=a[1];a=a[2];var e=b[0],f=b[1];b=b[2];return Math.abs(c-e)<=q.EPSILON*Math.max(1,Math.abs(c),Math.abs(e))&&
Math.abs(d-f)<=q.EPSILON*Math.max(1,Math.abs(d),Math.abs(f))&&Math.abs(a-b)<=q.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};var ga=function(a){a=void 0===a?{}:a;a=void 0===a.contentType?"blob":a.contentType;window.fetch||(this.req=new XMLHttpRequest);this.contentType=a};ga.prototype.loadItem=function(a,b){b=void 0===b?"blob":b;if(window.fetch)return fetch(a,{headers:{"Content-Type":"text/plain"}}).then(function(a){switch(b){case "blob":return a.blob();case "text":return a.text()}})};var ha=function(){};
ha.parseObj=function(a){function b(a){a=parseInt(a);return 3*(0<=a?a-1:a+p.length/3)}function c(a){a=parseInt(a);return 3*(0<=a?a-1:a+n.length/3)}function d(a){a=parseInt(a);return 2*(0<=a?a-1:a+u.length/2)}function e(a,b,c){m.push([p[a],p[a+1],p[a+2]]);m.push([p[b],p[b+1],p[b+2]]);m.push([p[c],p[c+1],p[c+2]]);q.push(3*r+0);q.push(3*r+1);q.push(3*r+2);r++}function f(a,b,c){l.push([u[a],u[a+1]]);l.push([u[b],u[b+1]]);l.push([u[c],u[c+1]])}function h(a,b,c){k.push([n[a],n[a+1],n[a+2]]);k.push([n[b],
n[b+1],n[b+2]]);k.push([n[c],n[c+1],n[c+2]])}function g(a,g,l,m,k,p,n,t,u,q,r,w){a=b(a);g=b(g);l=b(l);var v;void 0===m?e(a,g,l):(v=b(m),e(a,g,v),e(g,l,v));void 0!==k&&(a=d(k),g=d(p),l=d(n),void 0===m?f(a,g,l):(v=d(t),f(a,g,v),f(g,l,v)));void 0!==u&&(a=c(u),g=c(q),l=c(r),void 0===m?h(a,g,l):(v=c(w),h(a,g,v),h(g,l,v)))}a=a.split("\n");for(var m=[],l=[],k=[],p=[],n=[],u=[],q=[],r=0,t,w=/v( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,v=/vn( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,
x=/vt( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,y=/f( +-?\d+)( +-?\d+)( +-?\d+)( +-?\d+)?/,z=/f( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))?/,A=/f( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))?/,B=/f( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))?/,F=0;F<a.length;F++){var E=a[F],E=E.trim();0!==E.length&&"#"!==E.charAt(0)&&(null!==(t=w.exec(E))?p.push(parseFloat(t[1]),
parseFloat(t[2]),parseFloat(t[3])):null!==(t=v.exec(E))?n.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])):null!==(t=x.exec(E))?u.push(parseFloat(t[1]),parseFloat(t[2])):null!==(t=y.exec(E))?g(t[1],t[2],t[3],t[4]):null!==(t=z.exec(E))?g(t[2],t[5],t[8],t[11],t[3],t[6],t[9],t[12]):null!==(t=A.exec(E))?g(t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15],t[4],t[8],t[12],t[16]):null!==(t=B.exec(E))&&g(t[2],t[5],t[8],t[11],void 0,void 0,void 0,void 0,t[3],t[6],t[9],t[12]))}return{positions:m,coords:l,
normals:k,indices:q}};var A={create:function(){var a=new q.ARRAY_TYPE(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},fromMat4:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[4];a[4]=b[5];a[5]=b[6];a[6]=b[8];a[7]=b[9];a[8]=b[10];return a},clone:function(a){var b=new q.ARRAY_TYPE(9);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];
a[7]=b[7];a[8]=b[8];return a},fromValues:function(a,b,c,d,e,f,h,g,m){var l=new q.ARRAY_TYPE(9);l[0]=a;l[1]=b;l[2]=c;l[3]=d;l[4]=e;l[5]=f;l[6]=h;l[7]=g;l[8]=m;return l},set:function(a,b,c,d,e,f,h,g,m,l){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=h;a[6]=g;a[7]=m;a[8]=l;return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,b){if(a===b){var c=b[1],d=b[2],e=b[5];a[1]=b[3];a[2]=b[6];a[3]=c;a[5]=b[7];a[6]=d;a[7]=e}else a[0]=b[0],a[1]=b[3],
a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a},invert:function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],h=b[4],g=b[5],m=b[6],l=b[7];b=b[8];var k=b*h-g*l,p=-b*f+g*m,n=l*f-h*m,u=c*k+d*p+e*n;if(!u)return null;u=1/u;a[0]=k*u;a[1]=(-b*d+e*l)*u;a[2]=(g*d-e*h)*u;a[3]=p*u;a[4]=(b*c-e*m)*u;a[5]=(-g*c+e*f)*u;a[6]=n*u;a[7]=(-l*c+d*m)*u;a[8]=(h*c-d*f)*u;return a},adjoint:function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],h=b[4],g=b[5],m=b[6],l=b[7];b=b[8];a[0]=h*b-g*l;a[1]=e*l-d*b;a[2]=
d*g-e*h;a[3]=g*m-f*b;a[4]=c*b-e*m;a[5]=e*f-c*g;a[6]=f*l-h*m;a[7]=d*m-c*l;a[8]=c*h-d*f;return a},determinant:function(a){var b=a[3],c=a[4],d=a[5],e=a[6],f=a[7],h=a[8];return a[0]*(h*c-d*f)+a[1]*(-h*b+d*e)+a[2]*(f*b-c*e)},multiply:function(a,b,c){var d=b[0],e=b[1],f=b[2],h=b[3],g=b[4],m=b[5],l=b[6],k=b[7];b=b[8];var p=c[0],n=c[1],u=c[2],q=c[3],r=c[4],t=c[5],v=c[6],w=c[7];c=c[8];a[0]=p*d+n*h+u*l;a[1]=p*e+n*g+u*k;a[2]=p*f+n*m+u*b;a[3]=q*d+r*h+t*l;a[4]=q*e+r*g+t*k;a[5]=q*f+r*m+t*b;a[6]=v*d+w*h+c*l;a[7]=
v*e+w*g+c*k;a[8]=v*f+w*m+c*b;return a}};A.mul=A.multiply;A.translate=function(a,b,c){var d=b[0],e=b[1],f=b[2],h=b[3],g=b[4],m=b[5],l=b[6],k=b[7];b=b[8];var n=c[0];c=c[1];a[0]=d;a[1]=e;a[2]=f;a[3]=h;a[4]=g;a[5]=m;a[6]=n*d+c*h+l;a[7]=n*e+c*g+k;a[8]=n*f+c*m+b;return a};A.rotate=function(a,b,c){var d=b[0],e=b[1],f=b[2],h=b[3],g=b[4],m=b[5],l=b[6],k=b[7];b=b[8];var n=Math.sin(c);c=Math.cos(c);a[0]=c*d+n*h;a[1]=c*e+n*g;a[2]=c*f+n*m;a[3]=c*h-n*d;a[4]=c*g-n*e;a[5]=c*m-n*f;a[6]=l;a[7]=k;a[8]=b;return a};A.scale=
function(a,b,c){var d=c[0];c=c[1];a[0]=d*b[0];a[1]=d*b[1];a[2]=d*b[2];a[3]=c*b[3];a[4]=c*b[4];a[5]=c*b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a};A.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=b[0];a[7]=b[1];a[8]=1;return a};A.fromRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=c;a[2]=0;a[3]=-c;a[4]=b;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};A.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=b[1];a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};A.fromMat2d=
function(a,b){a[0]=b[0];a[1]=b[1];a[2]=0;a[3]=b[2];a[4]=b[3];a[5]=0;a[6]=b[4];a[7]=b[5];a[8]=1;return a};A.fromQuat=function(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];var f=c+c,h=d+d,g=e+e,c=c*f,m=d*f,d=d*h,l=e*f,k=e*h,e=e*g,f=b*f,h=b*h;b*=g;a[0]=1-d-e;a[3]=m-b;a[6]=l+h;a[1]=m+b;a[4]=1-c-e;a[7]=k-f;a[2]=l-h;a[5]=k+f;a[8]=1-c-d;return a};A.normalFromMat4=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],h=b[4],g=b[5],k=b[6],l=b[7],n=b[8],p=b[9],q=b[10],u=b[11],r=b[12],v=b[13],t=b[14];b=b[15];var w=c*g-d*h,
x=c*k-e*h,y=c*l-f*h,z=d*k-e*g,C=d*l-f*g,A=e*l-f*k,B=n*v-p*r,F=n*t-q*r,n=n*b-u*r,E=p*t-q*v,p=p*b-u*v,q=q*b-u*t,u=w*q-x*p+y*E+z*n-C*F+A*B;if(!u)return null;u=1/u;a[0]=(g*q-k*p+l*E)*u;a[1]=(k*n-h*q-l*F)*u;a[2]=(h*p-g*n+l*B)*u;a[3]=(e*p-d*q-f*E)*u;a[4]=(c*q-e*n+f*F)*u;a[5]=(d*n-c*p-f*B)*u;a[6]=(v*A-t*C+b*z)*u;a[7]=(t*y-r*A-b*x)*u;a[8]=(r*C-v*y+b*w)*u;return a};A.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};A.frob=function(a){return Math.sqrt(Math.pow(a[0],
2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};A.add=function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];a[6]=b[6]+c[6];a[7]=b[7]+c[7];a[8]=b[8]+c[8];return a};A.subtract=function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];a[4]=b[4]-c[4];a[5]=b[5]-c[5];a[6]=b[6]-c[6];a[7]=b[7]-c[7];a[8]=b[8]-c[8];return a};A.sub=A.subtract;A.multiplyScalar=
function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;a[6]=b[6]*c;a[7]=b[7]*c;a[8]=b[8]*c;return a};A.multiplyScalarAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;a[3]=b[3]+c[3]*d;a[4]=b[4]+c[4]*d;a[5]=b[5]+c[5]*d;a[6]=b[6]+c[6]*d;a[7]=b[7]+c[7]*d;a[8]=b[8]+c[8]*d;return a};A.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]};A.equals=function(a,
b){var c=a[0],d=a[1],e=a[2],f=a[3],h=a[4],g=a[5],k=a[6],l=a[7];a=a[8];var n=b[0],p=b[1],r=b[2],u=b[3],v=b[4],w=b[5],t=b[6],x=b[7];b=b[8];return Math.abs(c-n)<=q.EPSILON*Math.max(1,Math.abs(c),Math.abs(n))&&Math.abs(d-p)<=q.EPSILON*Math.max(1,Math.abs(d),Math.abs(p))&&Math.abs(e-r)<=q.EPSILON*Math.max(1,Math.abs(e),Math.abs(r))&&Math.abs(f-u)<=q.EPSILON*Math.max(1,Math.abs(f),Math.abs(u))&&Math.abs(h-v)<=q.EPSILON*Math.max(1,Math.abs(h),Math.abs(v))&&Math.abs(g-w)<=q.EPSILON*Math.max(1,Math.abs(g),
Math.abs(w))&&Math.abs(k-t)<=q.EPSILON*Math.max(1,Math.abs(k),Math.abs(t))&&Math.abs(l-x)<=q.EPSILON*Math.max(1,Math.abs(l),Math.abs(x))&&Math.abs(a-b)<=q.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};var x=function(a,b){var c=void 0===b?{}:b;b=void 0===c.vertex?"":c.vertex;var d=void 0===c.fragment?"":c.fragment,e=void 0===c.uniforms?[]:c.uniforms,c=void 0===c.mode?"":c.mode;this.vao=qa(a);this.gl=a;this.model=k.create();this.modelView=k.create();this.rotation={x:0,y:0,z:0};this.attributes={};this.numVertices=
3;this.normalMatrix=A.create();this.mode=""!==c?c:a.TRIANGLES;this.setNumInstances();this.rotateAxis=n.create();n.set(this.rotateAxis,this.rotation.x,this.rotation.y,this.rotation.z);this.scaleSize=n.create();this.position=n.create();""!==b&&""!==d&&this.setShader({vertex:b,fragment:d,uniforms:e})};x.prototype.setShader=function(a){var b=void 0===a?{}:a;a=void 0===b.vertex?"":b.vertex;var c=void 0===b.fragment?"":b.fragment,b=void 0===b.uniforms?[]:b.uniforms;""!==a&&""!==c&&(b=[].concat($jscomp.arrayFromIterable("projectionMatrix modelMatrix modelViewMatrix normalMatrix viewMatrix time uTime".split(" ")),
$jscomp.arrayFromIterable(b)),this.shader=sa(this.gl,{vertex:a,fragment:c,uniforms:b}),this.shaderSet=!0)};x.prototype.addAttribute=function(a,b,c,d){c=void 0===c?3:c;d=void 0===d?{}:d;if(this.shaderSet){var e=X(this.gl);b[0]instanceof Array&&(b=w(b));this.vao.bind();e.bind();e.bufferData(b);this.vao.addAttribute(this.shader,a,{size:c,dataOptions:d});e.unbind();this.vao.unbind();this.attributes[a]=e;return this}};x.prototype.addAttributeBuffer=function(a,b){if(this.shaderSet)return this.vao.bind(),
b.bind(),this.vao.addAttribute(this.shader,a,{size:size,dataOptions:dataOptions}),b.unbind(),this.vao.unbind(),this.attributes[a]=b,this};x.prototype.updateRawBuffer=function(a,b,c){var d=void 0===c?{}:c;c=void 0===d.size?3:d.size;var d=d.dataOptions,e=this.gl;this.vao.bind();e.bindBuffer(e.ARRAY_BUFFER,b);this.vao.addAttribute(this.shader,a,{size:c,dataOptions:d});e.bindBuffer(e.ARRAY_BUFFER,null);this.vao.unbind()};x.prototype.addInstancedAttributeBuffer=function(a,b,c){var d=void 0===c?{}:c;c=
void 0===d.size?3:d.size;d=d.dataOptions;if(this.shaderSet){var e=this.gl;b instanceof WebGLBuffer?(this.vao.bind(),e.bindBuffer(e.ARRAY_BUFFER,b),this.vao.addAttribute(this.shader,a,{size:c,dataOptions:d}),this.vao.makeInstancedAttribute(a),e.bindBuffer(e.ARRAY_BUFFER,null)):(this.vao.bind(),b.bind(),this.vao.addAttribute(this.shader,a,{size:c,dataOptions:d}),this.vao.makeInstancedAttribute(a),b.unbind());this.vao.unbind();this.attributes[a]=b;return this}};x.prototype.addInstancedAttribute=function(a,
b,c,d){c=void 0===c?3:c;d=void 0===d?{}:d;if(this.shaderSet){var e=X(this.gl);this.vao.bind();e.bind();e.bufferData(b);this.vao.addAttribute(this.shader,a,{size:c,dataOptions:d});this.vao.makeInstancedAttribute(a);e.unbind();this.vao.unbind();this.attributes[a]=e;this.instanced=!0;return this}};x.prototype.updateAttribute=function(a,b){a=this.attributes[a];this.vao.bind();a.bind();a.updateBuffer(b);a.unbind();this.vao.unbind()};x.prototype.setNumVertices=function(a,b){this.indicesSet||(10<a&&(a/=
void 0===b?3:b),this.numVertices=a);return a};x.prototype.addIndices=function(a){if(this.shaderSet){var b=X(this.gl,{indexed:!0});this.vao.bind();b.bind();b.bufferData(a);this.vao.unbind();b.unbind();this.indicesSet=!0;this.numVertices=a.length;return this}};x.prototype.setNumInstances=function(a){this.instanced&&(this.numInstances=void 0===a?1:a)};x.prototype.draw=function(a,b){this.shaderSet&&(this.shader.bind(),this.calculateNormalMatrix(a.view),this.shader.set4x4Uniform("projectionMatrix",a.projection),
this.shader.set4x4Uniform("modelViewMatrix",a.view),this.shader.set3x3Uniform("normalMatrix",this.normalMatrix),this.shader.uniform("viewMatrix",a.view),this.shader.uniform("view",a.view),this.shader.uniform("modelMatrix",this.model),this.shader.uniform("model",this.model),void 0!==b&&b(this.shader),this.vao.bind(),this.indicesSet&&!this.instanced?this.gl.drawElements(this.mode,this.numVertices,UNSIGNED_SHORT,0):this.instanced||this.gl.drawArrays(this.mode,0,this.numVertices),this.indicesSet&&this.instanced&&
this.gl.drawInstancedElements(this.mode,this.numVertices,this.numInstances),this.vao.unbind())};x.prototype.drawOrtho=function(a,b){this.shaderSet&&(this.shader.bind(),void 0!==b&&b(this.shader),this.vao.bind(),this.indicesSet&&!this.instanced?this.gl.drawElements(this.mode,this.numVertices,UNSIGNED_SHORT,0):this.instanced||this.gl.drawArrays(this.mode,0,this.numVertices),this.indicesSet&&this.instanced&&this.gl.drawInstancedElements(this.mode,this.numVertices,this.numInstances),this.vao.unbind())};
x.prototype.update=function(){};x.prototype.translate=function(a,b,c){n.set(this.position,void 0===a?1:a,void 0===b?1:b,void 0===c?0:c);k.translate(this.model,this.model,this.position)};x.prototype.translateX=function(a){n.set(this.position,a,this.position[1],this.position[2]);k.translate(this.model,this.model,this.position)};x.prototype.translateY=function(a){n.set(this.position,this.position[0],a,this.position[2]);k.translate(this.model,this.model,this.position)};x.prototype.translateZ=function(a){n.set(this.position,
this.position[0],this.position[1],a);k.translate(this.model,this.model,this.position)};x.prototype.scaleModel=function(a,b,c){n.set(this.scaleSize,void 0===a?1:a,void 0===b?1:b,void 0===c?1:c);k.scale(this.model,this.model,this.scaleSize);return this};x.prototype.rotateX=function(a){a=a*Math.PI/180;k.rotateX(this.model,this.model,a);return this};x.prototype.rotateY=function(a){a=a*Math.PI/180;k.rotateY(this.model,this.model,a);return this};x.prototype.rotateZ=function(a){a=a*Math.PI/180;k.rotateZ(this.model,
this.model,a);return this};x.prototype.scale=function(a){a instanceof Array&&4>a.length&&(k.scale(this.model,this.model,a),this.scaleSize.x=a[0],this.scaleSize.y=a[1],this.scaleSize.x=a[2]);return this};x.prototype.calculateNormalMatrix=function(a){var b=this.model,c=this.normalMatrix,d=this.modelView;k.identity(d);A.identity(c);k.multiply(d,b,a);A.fromMat4(c,d);A.invert(c,c);A.transpose(c,c);return this.normalMatrix=c};var ia=function(a,b,c){a=x.call(this,a,{vertex:U(a,{webgl1:"\nprecision highp float;\nattribute vec3 position;\nattribute vec2 uv;\nattribute vec3 aNormal;\nattribute vec2 aUV;\nuniform mat4 modelMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform sampler2D textureCurr;\nuniform sampler2D textureNext;\nuniform sampler2D textureExtra;\nuniform float percent;\nuniform float time;\nuniform vec2 uViewport;\nvarying vec2 vTextureCoord;\nvarying vec3 vNormal;\nmat4 rotationMatrix(vec3 axis, float angle) {\n    axis \x3d normalize(axis);\n    float s \x3d sin(angle);\n    float c \x3d cos(angle);\n    float oc \x3d 1.0 - c;\n    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n                0.0,                                0.0,                                0.0,                                1.0);\n}\nvec3 rotate(vec3 v, vec3 axis, float angle) {\n\tmat4 m \x3d rotationMatrix(axis, angle);\n\treturn (m * vec4(v, 1.0)).xyz;\n}\nvoid main(void) {\n\tvec3 posCurr \x3d texture2D(textureCurr, aUV).rgb;\n\tvec3 posNext \x3d texture2D(textureNext, aUV).rgb;\n\tvec3 pos     \x3d mix(posCurr, posNext, percent);\n\tvec3 extra   \x3d texture2D(textureExtra, aUV).rgb;\n\tfloat scale \x3d 0.1 + extra.g * 0.3;\n\tvec3 position \x3d rotate(position, normalize(extra), time * extra.r + extra.b ) * scale;\n\tposition +\x3d pos;\n    gl_Position \x3d projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.0);\n    vTextureCoord \x3d uv;\n    vNormal \x3d aNormal;\n}",
webgl2:"in vec3 position;\nin vec2 uv;\nin vec3 normal;\nin vec2 aUV;\nuniform mat4 modelMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform sampler2D textureCurr;\nuniform sampler2D textureNext;\nuniform sampler2D textureExtra;\nuniform float percent;\nuniform float time;\nuniform vec2 uViewport;\nuniform float scale;\nout vec2 vUv;\nout vec3 vNormal;\nmat4 rotationMatrix(vec3 axis, float angle) {\n    axis \x3d normalize(axis);\n    float s \x3d sin(angle);\n    float c \x3d cos(angle);\n    float oc \x3d 1.0 - c;\n    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n                0.0,                                0.0,                                0.0,                                1.0);\n}\nvec3 rotate(vec3 v, vec3 axis, float angle) {\n\tmat4 m \x3d rotationMatrix(axis, angle);\n\treturn (m * vec4(v, 1.0)).xyz;\n}\nvoid main(){\n    vec3 posCurr \x3d texture(textureCurr, aUV).rgb;\n\tvec3 posNext \x3d texture(textureNext, aUV).rgb;\n\tvec3 pos     \x3d mix(posCurr, posNext, percent);\n\tvec3 extra   \x3d texture(textureExtra, aUV).rgb;\n\tvec3 position \x3d rotate(position, normalize(extra), time * extra.r + extra.b ) * scale;\n\tposition +\x3d pos;\n    vNormal \x3d normal;\n    vUv \x3d uv;\n    gl_Position \x3d projectionMatrix * modelMatrix * viewMatrix * vec4(position,1.);\n }"}),
fragment:U(a,{webgl1:"\nvoid main(){\n    gl_FragColor \x3d vec4(1.);\n}",webgl2:"uniform vec2 resolution;\nuniform float time;\nout vec4 glFragColor;\nin vec3 vNormal;\nin vec2 vUv;\nconst vec3 col1 \x3d normalize(vec3(255,78,103));\nconst vec3 col2 \x3d normalize(vec3(204,42,65));\nvoid main(){\n    vec2 pc \x3d (2.0*gl_FragCoord.xy-resolution.xy)/min(resolution.y,resolution.x);\n    vec2 uv \x3d gl_FragCoord.xy / resolution.xy;\n    vec3 uvCol \x3d vec3(mix(uv,col1.xy,0.8),col2.y) * cos(time * 0.0005);\n    vec4 sc \x3d vec4(uvCol.xy, uv.x + mix(uvCol.y,col2.z,0.9) * sin(time),1.0);\n    vec4 sa \x3d sc;\n    vec3 col \x3d sc.xyz;\n    vec3 nor \x3d normalize( vec3( sa.x-sc.x, 0.01, sc.x-sc.x ) );\n\tfloat dif \x3d clamp(0.5 + 0.5*dot( nor,vec3(0.5773) ),0.0,1.0);\n\tcol *\x3d 0.5 + 0.7 * dif * col;\n\tcol +\x3d 0.3 * pow(nor.y,128.0);\n    glFragColor \x3d vec4(col,1.);\n}\n"}),
uniforms:["scale","percent","resolution","uViewport"]})||this;for(var d=[],e=0;e<c;++e)for(var f=0;f<c;++f)d.push(f/c,e/c);a.addAttribute("position",b.positions);a.addAttribute("uv",b.coords,2);a.addInstancedAttribute("aUV",d,2);a.addIndices(b.indices);a.setNumInstances();return a};$jscomp.inherits(ia,x);var Z=function(a,b){this.gl=a;this.flag=0;this._buildTextures(void 0===b?100:b)};Z.prototype._buildTextures=function(a){var b=this.gl,c=[],d=[],e=[],f=[],h=0,g=[],k=[];for(var l,n,p=0;p<a;p++)for(var q=0;q<a;q++)c.push(random(-3,3),random(-3,3),random(-3,3)),l=q/a*2-1+.5/a,n=p/a*2-1+.5/a,f.push(Math.random(),Math.random(),Math.random()),d.push(l,n),e.push(h),h++;var r=new Float32Array(a*a*4);c.forEach(function(a,b){r[b]=a});g.push(K(b,{width:a,height:a,data:r,floatingPoint:!0}));k.push(K(b,{width:a,height:a,data:r,floatingPoint:!0}));c=new Float32Array(a*a*4);d=c.length;for(e=0;e<d;e+=4)c[e]=0,c[e+1]=0,c[e+2]=0,c[e+3]=1;g.push(K(b,{width:a,height:a,floatingPoint:!0,
data:c}));k.push(K(b,{width:a,height:a,floatingPoint:!0,data:c}));var v=new Float32Array(a*a*4);f.forEach(function(a,b){v[b]=a});g.push(K(b,{width:a,height:a,floatingPoint:!0,data:v}));k.push(K(b,{width:a,height:a,floatingPoint:!0,data:v}));this.textures=g;this.textures2=k;this._buildBuffers()};Z.prototype._buildBuffers=function(){var a=this.gl;this.buffers=[Y(a,{format:ca(a,{textures:this.textures})}),Y(a,{format:ca(a,{textures:this.textures2})})];this.buffers[0].bind();this.buffers[0].drawBuffers();
this.buffers[0].unbind();this.buffers[1].bind();this.buffers[1].drawBuffers();this.buffers[1].unbind()};var R=function(a,b){var c=void 0===b?{}:b;b=void 0===c.vertex?null:c.vertex;var d=void 0===c.fragment?null:c.fragment,c=void 0===c.uniforms?["inputTexture"]:c.uniforms;a=x.call(this,a,{vertex:U(a,{webgl1:null!==b?b:"\nattribute vec2 position;\nvarying vec2 vUv;\nconst vec2 scale \x3d vec2(0.5,0.5);\nvoid main(){\n    vUv \x3d position.xy * scale + scale;\n    gl_Position \x3d vec4(position,0.0,1.0);\n}",
webgl2:null!==b?b:"\nin vec2 position;\nout vec2 vUv;\nconst vec2 scale \x3d vec2(0.5,0.5);\nvoid main(){\n    vUv \x3d position.xy * scale + scale;\n    gl_Position \x3d vec4(position,0.0,1.0);\n}"}),fragment:U(a,{webgl1:null!==d?d:"precision highp float;\nuniform sampler2D inputTexture;\nvarying vec2 vUv;\nvoid main(){\n    vec4 tex \x3d texture2D(inputTexture,vUv);\n    gl_FragColor \x3d vec4(tex.xyz,1.0);\n}",webgl2:null!==d?d:"precision highp float;\nuniform sampler2D inputTexture;\nin vec2 vUv;\nout vec4 glfragColor;\nvoid main(){\n    vec4 tex \x3d texture(inputTexture,vUv);\n    glfragColor \x3d tex;\n}"}),
uniforms:c})||this;a.addAttribute("position",[-1,-1,-1,4,4,-1],2);a.addIndices([2,1,0]);return a};$jscomp.inherits(R,x);R.prototype.draw=function(a){a=void 0===a?null:a;this.shader.bind();null!==a&&a(this.shader);this.vao.bind();this.gl.drawArrays(this.mode,0,this.numVertices);this.vao.unbind()};R.prototype.drawTexture=function(a,b){a=void 0===a?null:a;b=void 0===b?null:b;this.shader.bind();null!==b&&b(this.shader);a.bind();this.shader.setTextureUniform("inputTexture",0);this.vao.bind();this.gl.drawArrays(this.mode,
0,this.numVertices);this.vao.unbind();a.unbind()};var B=1/((1+Math.sqrt(5))/2),ja=function(a){a=x.call(this,a,{vertex:"// attributes of our mesh\r\nin vec3 position;\r\n\r\n// built-in uniforms from ThreeJS camera and Object3D\r\nuniform mat4 projectionMatrix;\r\nuniform mat4 modelViewMatrix;\r\nuniform mat4 modelMatrix;\r\nuniform mat3 normalMatrix;\r\n\r\nvoid main(){\r\n    gl_Position \x3d projectionMatrix * modelMatrix * modelViewMatrix * vec4(position,1.);\r\n}",fragment:"\r\nout vec4 glFragColor;\r\nvoid main(){\r\n    glFragColor \x3d vec4(1.0,0.0,0.0,1.0);\r\n}"})||
this;var b;var c=wa();b=[];if(c.hasOwnProperty("cells")||c.hasOwnProperty("indices")){for(var d=void 0!==c.cells?c.cells:c.indices,c=c.vertices,e=[],f=0;f<d.length;f+=3)e.push([d[f],d[f+1],d[f+2]]);for(d=0;d<e.length;++d){var f=b.length,h=e[d];b.push(c[h[0]],c[h[1]],c[h[2]]);h[0]=f;h[1]=f+1;h[2]=f+2}b={vertices:w(b),indices:w(e)}}else console.warn("Explode modifier can't be used because the geometry doesn't have indices"),b=!1;a.addAttribute("position",b.vertices);a.addIndices(b.indices);
return a};$jscomp.inherits(ja,x);var H=function(a,b){var c=void 0===b?{}:b;b=void 0===c.width?window.innerWidth:c.width;var d=void 0===c.height?window.innerHeight:c.height,e=void 0===c.vertex?null:c.vertex,f=void 0===c.fragment?null:c.fragment,c=void 0===c.uniforms?[]:c.uniforms;this.gl=a;this.input=null;this.isInComposer=!1;this.resolution=[b,d];this.fbo=Y(a,{width:b,height:d});this.drawQuad=new R(a,{vertex:e,fragment:f,uniforms:c})};H.prototype.bindView=function(a,b){a=void 0===a?0:a;b=void 0===
b?0:b;this.fbo.bind();this.gl.viewport(a,b,this.resolution[0],this.resolution[1])};H.prototype.unbindView=function(){this.fbo.unbind()};H.prototype.setResizeListener=function(a){a=void 0===a?{}:a;var b=void 0===a.width?window.innerWidth:a.width,c=void 0===a.height?window.innerHeight:a.height,d=this;this.resizeListenerOn=!0;window.addEventListener("resize",function(){d.fbo.resize(b,c);d.resolution[0]=window.innerWidth;d.resolution[1]=window.innerHeight;d.gl.viewport(0,0,d.resolution[0],d.resolution[1])})};
H.prototype.draw=function(){this.drawQuad.drawTexture(this.fbo.getTexture())};H.prototype.setInput=function(a){this.isInComposer=!0;this.input=a};H.prototype.runPass=function(){var a=this,b=this.gl;this.isInComposer&&(this.fbo.bind(),this.gl.clearScreen(),b.enableAdditiveBlending(),this.input.bind(),this.drawQuad.drawTexture(this.input,function(b){b.uniform("inputTexture",0);b.uniform("resolution",a.resolution)}),this.input.unbind(),this.fbo.unbind(),b.disableBlending())};H.prototype.drawComposedLayer=
function(){this.isInComposer&&this.drawQuad.drawTexture(this.fbo.getTexture())};H.prototype.getComposedLayer=function(){return this.fbo.getTexture()};H.prototype.getTexture=function(){return this.fbo.getTexture()};var O=function(a){a=H.call(this,a)||this;a.passes=[];return a};$jscomp.inherits(O,H);O.prototype.addLayer=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];b[0]instanceof H&&(this.passes=b)};O.prototype.compileLayers=function(a){a=void 0===a?{}:a;var b=void 0===a.resize?
!0:a.resize,c=this;this._sortPasses();var d=null;0<this.passes.length?d=this.passes[this.passes.length-1]:this.passes.push(this);window.addEventListener("resize",function(){c.resolution[0]=window.innerWidth;c.resolution[1]=window.innerHeight;c.gl.viewport(0,0,window.innerWidth,window.innerHeight);b&&(c.fbo.resize(window.innerWidth,window.innerHeight),c.passes.forEach(function(a){a.fbo.resize(window.innerWidth,window.innerHeight)}),1<c.passes.length&&null!==d.input&&d.input.resize(window.innerWidth,
window.innerHeight))})};O.prototype.run=function(){this.passes.forEach(function(a){a.runPass()})};O.prototype.drawComposedScene=function(){this.drawQuad.drawTexture(this.passes[this.passes.length-1].getComposedLayer())};O.prototype._sortPasses=function(){var a=this,b=this.passes,c=0,d=[];b.forEach(function(e){0===c?e.setInput(a.fbo.getTexture()):e.setInput(b[c-1].fbo.getTexture());d.push(e);c++});this.passes=d};var aa=function(a){return H.call(this,a,{fragment:"\nuniform vec2 direction;\nuniform vec2 resolution;\nuniform sampler2D uScene;\nin vec2 vUv;\nout vec4 glFragColor;\nvec4 blur13(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color \x3d vec4(0.0);\n  vec2 off1 \x3d vec2(1.411764705882353) * direction;\n  vec2 off2 \x3d vec2(3.2941176470588234) * direction;\n  vec2 off3 \x3d vec2(5.176470588235294) * direction;\n  color +\x3d texture(image, uv) * 0.1964825501511404;\n  color +\x3d texture(image, uv + (off1 / resolution)) * 0.2969069646728344;\n  color +\x3d texture(image, uv - (off1 / resolution)) * 0.2969069646728344;\n  color +\x3d texture(image, uv + (off2 / resolution)) * 0.09447039785044732;\n  color +\x3d texture(image, uv - (off2 / resolution)) * 0.09447039785044732;\n  color +\x3d texture(image, uv + (off3 / resolution)) * 0.010381362401148057;\n  color +\x3d texture(image, uv - (off3 / resolution)) * 0.010381362401148057;\n  return color;\n}\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color \x3d vec4(0.0);\n  vec2 off1 \x3d vec2(1.3846153846) * direction;\n  vec2 off2 \x3d vec2(3.2307692308) * direction;\n  color +\x3d texture(image, uv) * 0.2270270270;\n  color +\x3d texture(image, uv + (off1 / resolution)) * 0.3162162162;\n  color +\x3d texture(image, uv - (off1 / resolution)) * 0.3162162162;\n  color +\x3d texture(image, uv + (off2 / resolution)) * 0.0702702703;\n  color +\x3d texture(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\nvoid main()\n{\n    vec2 pixelUv \x3d vec2(gl_FragCoord.xy / resolution.xy);\n    vec4 dat \x3d texture(uScene,vUv);\n    vec4 blurScene \x3d blur13(uScene,vUv,resolution,direction);\n    vec4 blurScene2 \x3d blur9(uScene,vUv,resolution,direction);\n    glFragColor \x3d blurScene2 * blurScene;\n}\n",
uniforms:["resolution","direction"]})||this};$jscomp.inherits(aa,H);aa.prototype.runPass=function(){var a=this.gl;this.bindView();a.clearScreen(0,0,0,0);null!==this.input&&this.input.bind();this.drawQuad.drawTexture(this.input,function(a){a.uniform("resolution",[window.innerWidth,window.innerHeight]);a.uniform("direction",[1,0])});this.unbindView()};var S=function(a,b,c,d){var e;e=O.call(this,a)||this;e.time=0;e.count=0;e.camera=c;e.numParticles=d;e.petals=new ia(a,b,d);e.quad=new R(a);e.data=new Z(a,
d);e.shape=new ja(a);e.sim=new R(a,{fragment:U(a,{webgl1:"\n#extension GL_EXT_draw_buffers : require\nprecision highp float;\nvarying vec2 vUv;\nuniform sampler2D textureVel;\nuniform sampler2D texturePos;\nuniform sampler2D textureExtra;\nuniform float time;\nuniform float maxRadius;\nvec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0;  }\nvec4 mod289(vec4 x) { return x - floor(x * (1.0 / 289.0)) * 289.0;  }\nvec4 permute(vec4 x) {  return mod289(((x*34.0)+1.0)*x);  }\nvec4 taylorInvSqrt(vec4 r) {  return 1.79284291400159 - 0.85373472095314 * r;}\nfloat snoise(vec3 v) {\n\tconst vec2  C \x3d vec2(1.0/6.0, 1.0/3.0) ;\n\tconst vec4  D \x3d vec4(0.0, 0.5, 1.0, 2.0);\n\tvec3 i  \x3d floor(v + dot(v, C.yyy) );\n\tvec3 x0 \x3d   v - i + dot(i, C.xxx) ;\n\tvec3 g \x3d step(x0.yzx, x0.xyz);\n\tvec3 l \x3d 1.0 - g;\n\tvec3 i1 \x3d min( g.xyz, l.zxy );\n\tvec3 i2 \x3d max( g.xyz, l.zxy );\n\tvec3 x1 \x3d x0 - i1 + C.xxx;\n\tvec3 x2 \x3d x0 - i2 + C.yyy;\tvec3 x3 \x3d x0 - D.yyy;\n\ti \x3d mod289(i);\n\tvec4 p \x3d permute( permute( permute(\n\t\t\t\t\t\t i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n\t\t\t\t\t + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n\t\t\t\t\t + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\tfloat n_ \x3d 0.142857142857;\tvec3  ns \x3d n_ * D.wyz - D.xzx;\n\tvec4 j \x3d p - 49.0 * floor(p * ns.z * ns.z);\n\tvec4 x_ \x3d floor(j * ns.z);\n\tvec4 y_ \x3d floor(j - 7.0 * x_ );\n\tvec4 x \x3d x_ *ns.x + ns.yyyy;\n\tvec4 y \x3d y_ *ns.x + ns.yyyy;\n\tvec4 h \x3d 1.0 - abs(x) - abs(y);\n\tvec4 b0 \x3d vec4( x.xy, y.xy );\n\tvec4 b1 \x3d vec4( x.zw, y.zw );\n\tvec4 s0 \x3d floor(b0)*2.0 + 1.0;\n\tvec4 s1 \x3d floor(b1)*2.0 + 1.0;\n\tvec4 sh \x3d -step(h, vec4(0.0));\n\tvec4 a0 \x3d b0.xzyw + s0.xzyw*sh.xxyy ;\n\tvec4 a1 \x3d b1.xzyw + s1.xzyw*sh.zzww ;\n\tvec3 p0 \x3d vec3(a0.xy,h.x);\n\tvec3 p1 \x3d vec3(a0.zw,h.y);\n\tvec3 p2 \x3d vec3(a1.xy,h.z);\n\tvec3 p3 \x3d vec3(a1.zw,h.w);\n\tvec4 norm \x3d taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n\tp0 *\x3d norm.x;\n\tp1 *\x3d norm.y;\n\tp2 *\x3d norm.z;\n\tp3 *\x3d norm.w;\n\tvec4 m \x3d max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n\tm \x3d m * m;\n\treturn 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdot(p2,x2), dot(p3,x3) ) );\n}\nvec3 snoiseVec3( vec3 x ){\n\tfloat s  \x3d snoise(vec3( x ));\n\tfloat s1 \x3d snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));\n\tfloat s2 \x3d snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));\n\tvec3 c \x3d vec3( s , s1 , s2 );\n\treturn c;\n}\nvec3 curlNoise( vec3 p ){\n\tconst float e \x3d .1;\n\tvec3 dx \x3d vec3( e   , 0.0 , 0.0 );\n\tvec3 dy \x3d vec3( 0.0 , e   , 0.0 );\n\tvec3 dz \x3d vec3( 0.0 , 0.0 , e   );\n\tvec3 p_x0 \x3d snoiseVec3( p - dx );\n\tvec3 p_x1 \x3d snoiseVec3( p + dx );\n\tvec3 p_y0 \x3d snoiseVec3( p - dy );\n\tvec3 p_y1 \x3d snoiseVec3( p + dy );\n\tvec3 p_z0 \x3d snoiseVec3( p - dz );\n\tvec3 p_z1 \x3d snoiseVec3( p + dz );\n\tfloat x \x3d p_y1.z - p_y0.z - p_z1.y + p_z0.y;\n\tfloat y \x3d p_z1.x - p_z0.x - p_x1.z + p_x0.z;\n\tfloat z \x3d p_x1.y - p_x0.y - p_y1.x + p_y0.x;\n\tconst float divisor \x3d 1.0 / ( 2.0 * e );\n\treturn normalize( vec3( x , y , z ) * divisor );\n}\nvec2 rotate(vec2 v, float a) {\n\tfloat s \x3d sin(a);\n\tfloat c \x3d cos(a);\n\tmat2 m \x3d mat2(c, -s, s, c);\n\treturn m * v;\n}\nconst float PI \x3d 3.141592653;\nvoid main(void) {\n\tvec3 pos        \x3d texture2D(texturePos, vUv).rgb;\n\tvec3 vel        \x3d texture2D(textureVel, vUv).rgb;\n\tvec3 extra      \x3d texture2D(textureExtra, vUv).rgb;\n\tfloat posOffset \x3d mix(extra.r, 1.0, 0.2) * .25;\n\tvec3 acc        \x3d curlNoise(pos * posOffset + time * .3);\n\tvel +\x3d acc * .002;\n\tvec2 v \x3d normalize(pos.xz);\n\tv \x3d rotate(v, PI * 0.6);\n\tvel.xz +\x3d v * 0.005;\n\tfloat dist \x3d length(pos);\n\tvec3 dir \x3d normalize(pos);\n\tif(dist \x3e maxRadius) {\n\t\tfloat f \x3d (dist - maxRadius) * .0025;\n\t\tvel -\x3d dir * f;\n\t}\n\tconst float minRadius \x3d 2.0;\n\tif(dist \x3c minRadius) {\n\t\tfloat f \x3d (minRadius - dist) * 0.1;\n\t\tvel +\x3d dir * f;\n\t}\n\tconst float decrease \x3d .93;\n\tvel *\x3d decrease;\n\tgl_FragData[0] \x3d vec4(pos + vel, 1.0);\n\tgl_FragData[1] \x3d vec4(vel, 1.0);\n\tgl_FragData[2] \x3d vec4(extra, 1.0);\n\tgl_FragData[3] \x3d vec4(0.0, 0.0, 0.0, 1.0);\n}",
webgl2:"\nin vec2 vUv;\nuniform sampler2D textureVel;\nuniform sampler2D texturePos;\nuniform sampler2D textureExtra;\nuniform float time;\nuniform float maxRadius;\nlayout (location \x3d 0) out vec4 oOut0;\nlayout (location \x3d 1) out vec4 oOut1;\nlayout (location \x3d 2) out vec4 oOut2;\nlayout (location \x3d 3) out vec4 oOut3;\nvec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0;  }\nvec4 mod289(vec4 x) { return x - floor(x * (1.0 / 289.0)) * 289.0;  }\nvec4 permute(vec4 x) {  return mod289(((x*34.0)+1.0)*x);  }\nvec4 taylorInvSqrt(vec4 r) {  return 1.79284291400159 - 0.85373472095314 * r;}\nfloat snoise(vec3 v) {\n\tconst vec2  C \x3d vec2(1.0/6.0, 1.0/3.0) ;\n\tconst vec4  D \x3d vec4(0.0, 0.5, 1.0, 2.0);\n\tvec3 i  \x3d floor(v + dot(v, C.yyy) );\n\tvec3 x0 \x3d   v - i + dot(i, C.xxx) ;\n\tvec3 g \x3d step(x0.yzx, x0.xyz);\n\tvec3 l \x3d 1.0 - g;\n\tvec3 i1 \x3d min( g.xyz, l.zxy );\n\tvec3 i2 \x3d max( g.xyz, l.zxy );\n\tvec3 x1 \x3d x0 - i1 + C.xxx;\n\tvec3 x2 \x3d x0 - i2 + C.yyy;\tvec3 x3 \x3d x0 - D.yyy;\n\ti \x3d mod289(i);\n\tvec4 p \x3d permute( permute( permute(\n\t\t\t\t\t\t i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n\t\t\t\t\t + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n\t\t\t\t\t + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\tfloat n_ \x3d 0.142857142857;\tvec3  ns \x3d n_ * D.wyz - D.xzx;\n\tvec4 j \x3d p - 49.0 * floor(p * ns.z * ns.z);\n\tvec4 x_ \x3d floor(j * ns.z);\n\tvec4 y_ \x3d floor(j - 7.0 * x_ );\n\tvec4 x \x3d x_ *ns.x + ns.yyyy;\n\tvec4 y \x3d y_ *ns.x + ns.yyyy;\n\tvec4 h \x3d 1.0 - abs(x) - abs(y);\n\tvec4 b0 \x3d vec4( x.xy, y.xy );\n\tvec4 b1 \x3d vec4( x.zw, y.zw );\n\tvec4 s0 \x3d floor(b0)*2.0 + 1.0;\n\tvec4 s1 \x3d floor(b1)*2.0 + 1.0;\n\tvec4 sh \x3d -step(h, vec4(0.0));\n\tvec4 a0 \x3d b0.xzyw + s0.xzyw*sh.xxyy ;\n\tvec4 a1 \x3d b1.xzyw + s1.xzyw*sh.zzww ;\n\tvec3 p0 \x3d vec3(a0.xy,h.x);\n\tvec3 p1 \x3d vec3(a0.zw,h.y);\n\tvec3 p2 \x3d vec3(a1.xy,h.z);\n\tvec3 p3 \x3d vec3(a1.zw,h.w);\n\tvec4 norm \x3d taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n\tp0 *\x3d norm.x;\n\tp1 *\x3d norm.y;\n\tp2 *\x3d norm.z;\n\tp3 *\x3d norm.w;\n\tvec4 m \x3d max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n\tm \x3d m * m;\n\treturn 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdot(p2,x2), dot(p3,x3) ) );\n}\nvec3 snoiseVec3( vec3 x ){\n\tfloat s  \x3d snoise(vec3( x ));\n\tfloat s1 \x3d snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));\n\tfloat s2 \x3d snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));\n\tvec3 c \x3d vec3( s , s1 , s2 );\n\treturn c;\n}\nvec3 curlNoise( vec3 p ){\n\tconst float e \x3d .1;\n\tvec3 dx \x3d vec3( e   , 0.0 , 0.0 );\n\tvec3 dy \x3d vec3( 0.0 , e   , 0.0 );\n\tvec3 dz \x3d vec3( 0.0 , 0.0 , e   );\n\tvec3 p_x0 \x3d snoiseVec3( p - dx );\n\tvec3 p_x1 \x3d snoiseVec3( p + dx );\n\tvec3 p_y0 \x3d snoiseVec3( p - dy );\n\tvec3 p_y1 \x3d snoiseVec3( p + dy );\n\tvec3 p_z0 \x3d snoiseVec3( p - dz );\n\tvec3 p_z1 \x3d snoiseVec3( p + dz );\n\tfloat x \x3d p_y1.z - p_y0.z - p_z1.y + p_z0.y;\n\tfloat y \x3d p_z1.x - p_z0.x - p_x1.z + p_x0.z;\n\tfloat z \x3d p_x1.y - p_x0.y - p_y1.x + p_y0.x;\n\tconst float divisor \x3d 1.0 / ( 2.0 * e );\n\treturn normalize( vec3( x , y , z ) * divisor );\n}\nvec2 rotate(vec2 v, float a) {\n\tfloat s \x3d sin(a);\n\tfloat c \x3d cos(a);\n\tmat2 m \x3d mat2(c, -s, s, c);\n\treturn m * v;\n}\nconst float PI \x3d 3.141592653;\nvoid main(void) {\n    vec3 pos        \x3d texture(texturePos, vUv).rgb;\n   \tvec3 vel        \x3d texture(textureVel, vUv).rgb;\n    vec3 extra      \x3d texture(textureExtra, vUv).rgb;\n   \tfloat posOffset \x3d mix(extra.r, 1.0, 0.2) * 2.25;\n   \tposOffset +\x3d 2.0;\n   \tvec3 acc \x3d curlNoise(pos * posOffset + time * .3);\n    vel +\x3d acc * .02;\n    vec2 v \x3d normalize(pos.xz);\n    v \x3d rotate(v, PI * 0.6);\n    vel.xz +\x3d v * 0.005;\n    float dist \x3d length(pos);\n    vec3 dir \x3d normalize(pos);\n    if(dist \x3e maxRadius) {\n    \tfloat f \x3d (dist - maxRadius);\n    \tvel -\x3d dir * f;\n    }\n    const float minRadius \x3d 2.0;\n    if(dist \x3c minRadius) {\n        float f \x3d (minRadius - dist) * 0.1;\n    \tvel +\x3d dir * f;\n    }\n    const float decrease \x3d 0.98;\n    vel *\x3d decrease;\n    oOut0 \x3d vec4(pos + vel, 1.0);\n    oOut1 \x3d vec4(vel, 1.0);\n    oOut2 \x3d vec4(extra, 1.0);\n    oOut3 \x3d vec4(maxRadius, 1.0, 0.0, 1.0);\n}"}),
uniforms:["texturePos","textureVel","textureExtra","maxRadius"]});e.resolution=[window.innerWidth,window.innerHeight];e.petals.setNumInstances(e.numParticles);e.current=e.data.buffers[0];e.target=e.data.buffers[1];e.gl instanceof WebGL2RenderingContext&&(e.blur=new aa(e.gl),e.addLayer(e.blur),e.compileLayers());return e};$jscomp.inherits(S,O);S.prototype.updateFbo=function(){var a=this.gl;this.target.bind();a.clearScreen();this.current.getTexture(1).bind(0);this.current.getTexture().bind(1);this.current.getTexture(2).bind(2);
a.setViewport(0,0,this.numParticles,this.numParticles);this.sim.draw(function(a){a.setTextureUniform("texturePos",1);a.setTextureUniform("textureVel",0);a.setTextureUniform("textureExtra",2);a.uniform("time",deltaTime);a.uniform("maxRadius",40.5)});a.bindTexture(a.TEXTURE_2D,null);this.target.unbind();a=this.current;this.current=this.target;this.target=a};S.prototype.renderPetals=function(){var a=this,b=this.gl;this.time+=.05;this.count++;0==this.count%2&&(this.count=0,this.updateFbo());this.bindView();
b.setViewport();b.clearScreen(0,0,0,0);b.disableBlending();this.target.getTexture().bind(0);this.target.getTexture().bind(1);this.target.getTexture(2).bind(2);this.petals.draw(this.camera,function(b){b.setTextureUniform("textureCurr",0);b.setTextureUniform("textureNext",1);b.setTextureUniform("textureExtra",2);b.uniform("percent",a.count);b.uniform("resolution",a.resolution);b.uniform("time",.001*deltaTime);b.uniform("scale",1)});b.bindTexture(b.TEXTURE_2D,null);this.unbindView()};S.prototype.update=
function(){this.renderPetals()};S.prototype.draw=function(){this.gl.setViewport();this.gl instanceof WebGL2RenderingContext&&(this.run(),this.drawComposedScene())};var y={create:function(){var a=new q.ARRAY_TYPE(2);a[0]=0;a[1]=0;return a},clone:function(a){var b=new q.ARRAY_TYPE(2);b[0]=a[0];b[1]=a[1];return b},fromValues:function(a,b){var c=new q.ARRAY_TYPE(2);c[0]=a;c[1]=b;return c},copy:function(a,b){a[0]=b[0];a[1]=b[1];return a},set:function(a,b,c){a[0]=b;a[1]=c;return a},add:function(a,b,c){a[0]=
b[0]+c[0];a[1]=b[1]+c[1];return a},subtract:function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];return a}};y.sub=y.subtract;y.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];return a};y.mul=y.multiply;y.divide=function(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];return a};y.div=y.divide;y.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);return a};y.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);return a};y.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);
return a};y.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);return a};y.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);return a};y.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;return a};y.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;return a};y.distance=function(a,b){var c=b[0]-a[0];a=b[1]-a[1];return Math.sqrt(c*c+a*a)};y.dist=y.distance;y.squaredDistance=function(a,b){var c=b[0]-a[0];a=b[1]-a[1];return c*c+a*a};y.sqrDist=y.squaredDistance;
y.length=function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)};y.len=y.length;y.squaredLength=function(a){var b=a[0];a=a[1];return b*b+a*a};y.sqrLen=y.squaredLength;y.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];return a};y.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];return a};y.normalize=function(a,b){var c=b[0],d=b[1],c=c*c+d*d;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c);return a};y.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};y.cross=function(a,b,c){b=b[0]*c[1]-b[1]*c[0];a[0]=a[1]=0;a[2]=
b;return a};y.lerp=function(a,b,c,d){var e=b[0];b=b[1];a[0]=e+d*(c[0]-e);a[1]=b+d*(c[1]-b);return a};y.random=function(a,b){b=b||1;var c=2*q.RANDOM()*Math.PI;a[0]=Math.cos(c)*b;a[1]=Math.sin(c)*b;return a};y.transformMat2=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b;a[1]=c[1]*d+c[3]*b;return a};y.transformMat2d=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b+c[4];a[1]=c[1]*d+c[3]*b+c[5];return a};y.transformMat3=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[3]*b+c[6];a[1]=c[1]*d+c[4]*
b+c[7];return a};y.transformMat4=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[4]*b+c[12];a[1]=c[1]*d+c[5]*b+c[13];return a};y.forEach=function(){var a=y.create();return function(b,c,d,e,f,h){c||(c=2);d||(d=0);for(e=e?Math.min(e*c+d,b.length):b.length;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],f(a,a,h),b[d]=a[0],b[d+1]=a[1];return b}}();y.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};y.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]};y.equals=function(a,b){var c=a[0];a=a[1];var d=b[0];b=b[1];
return Math.abs(c-d)<=q.EPSILON*Math.max(1,Math.abs(c),Math.abs(d))&&Math.abs(a-b)<=q.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};var T=function(a,b){var c=void 0===b?{}:b;b=void 0===c.numSides?8:c.numSides;var d=void 0===c.subdivisions?50:c.subdivisions,c=void 0===c.openEnded?!1:c.openEnded;a=x.call(this,a,{vertex:"in float position;\nin float angle;\nin vec2 uv;\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat3 normalMatrix;\nuniform mat4 modelMatrix;\nuniform float thickness;\nuniform float time;\nuniform float animateRadius;\nuniform float animateStrength;\nuniform float index;\nuniform float radialSegments;\nout vec2 vUv;\nout vec3 vViewPosition;\nout vec3 vNormal;\nout float vThickness;\n#define PI 3.14149\nconst float lengthSegments \x3d 200.0;\n#define PI 3.14149\nfloat ease(float t) {\n  return t \x3d\x3d 0.0 || t \x3d\x3d 1.0\n    ? t\n    : t \x3c 0.5\n      ? +0.5 * pow(2.0, (20.0 * t) - 10.0)\n      : -0.5 * pow(2.0, 10.0 - (t * 20.0)) + 1.0;\n}\nvec3 spherical (float r, float phi, float theta) {\n  return r * vec3(\n    cos(phi) * cos(theta),\n    cos(phi) * sin(theta),\n    sin(phi)\n  );\n}\nvec3 sampleCurve(float t) {\n  float beta \x3d t * PI;\n  float ripple \x3d ease(sin(t * 2.0 * PI + time) * 0.5 + 0.5) * 0.5;\n  float noise \x3d time + index * ripple * 8.0;\n  float radiusAnimation \x3d animateRadius * animateStrength * 0.25;\n  float r \x3d sin(index * 0.75 + beta * 2.0) * (0.75 + radiusAnimation);\n  float theta \x3d 4.0 * beta + index * 0.25;\n  float phi \x3d sin(index * 2.0 + beta * 8.0 + noise);\n    vec3 val \x3d spherical(r, phi, theta);\n  return val;\n}\nvoid createTube (float t, vec2 volume, out vec3 offset, out vec3 normal) {\n  float nextT \x3d t + (1.0 / lengthSegments);\n  vec3 current \x3d sampleCurve(t);\n  vec3 next \x3d sampleCurve(nextT);\n  vec3 T \x3d normalize(next - current);\n  vec3 B \x3d normalize(cross(T, next + current));\n  vec3 N \x3d -normalize(cross(B, T));\n  float tubeAngle \x3d angle;\n  float circX \x3d cos(tubeAngle);\n  float circY \x3d sin(tubeAngle);\n  normal.xyz \x3d normalize(B * circX + N * circY);\n  offset.xyz \x3d current + B * volume.x * circX + N * volume.y * circY;\n}\nvoid main() {\n  float t \x3d (position * 2.0) * 0.5 + 0.5;\n  vec2 volume \x3d vec2(thickness);\n  float volumeAngle \x3d t * lengthSegments * 0.5 + index * 20.0 + time;\n  float volumeMod \x3d sin(volumeAngle) * 0.5 + 0.5;\n  volume +\x3d 0.01 * volumeMod;\n  vec3 transformed;\n  vec3 objectNormal;\n  createTube(t, volume, transformed, objectNormal);\n  vec3 transformedNormal \x3d normalMatrix * objectNormal;\n  vNormal \x3d normalize(transformedNormal);\n  vUv \x3d uv.yx;\n  transformed.x *\x3d 5.0;\n  transformed.y *\x3d 5.0;\n  transformed.z *\x3d 5.0;\n  vec4 mvPosition \x3d modelMatrix * modelViewMatrix * vec4(transformed, 1.0);\n  vViewPosition \x3d -mvPosition.xyz;\n  gl_Position \x3d projectionMatrix * mvPosition;\n}",
fragment:"\nout vec4 glFragColor;\nin float vThickness;\nvoid main(){\n    glFragColor \x3d vec4(1.0,0.0,vThickness,1.0);\n}",uniforms:["thickness","index","radialSegments"]})||this;b=xa(b,d,c);a.thickness=Q(.005,.0032);a.numVertices=b.positions.length/3;a.addAttribute("position",b.positions,1);a.addAttribute("angle",b.angles,1);a.addAttribute("uv",b.uvs,2);return a};$jscomp.inherits(T,x);T=function(a,b){this.gl=a;this.camera=b;this.lastUpdate=0;this.numParticles=500};T.prototype.updateTime=function(){var a=
Date.now(),b=a-this.lastUpdate;this.lastUpdate=a;window.deltaTime=b};T.prototype.setup=function(a){this.petals=new S(this.gl,a,this.camera,this.numParticles)};T.prototype.draw=function(){var a=this.gl;this.updateTime();this.petals.update();a.clearTransparent();a.enableAlphaBlending();this.petals.draw()};var za=function(a){var b=void 0===a?{}:a;a=void 0===b.canvas?null:b.canvas;var c=void 0===b.getCommonExtensions?!0:b.getCommonExtensions,d=void 0===b.width?300:b.width,e=void 0===b.height?150:b.height;
a=oa(a,void 0===b.ctxOptions?{}:b.ctxOptions,void 0===b.webgl1?!1:b.webgl1);d=new fa(d,e);e={FLOAT:a.FLOAT,UNSIGNED_BYTE:a.UNSIGNED_BYTE,UNSIGNED_SHORT:a.UNSIGNED_SHORT,ARRAY_BUFFER:a.ARRAY_BUFFER,ELEMENT_BUFFER:a.ELEMENT_ARRAY_BUFFER,RGBA:a.RGBA,RGB:a.RGB,RGBA16F:a.RGBA16F,TEXTURE_2D:a.TEXTURE_2D,STATIC_DRAW:a.STATIC_DRAW,DYNAMIC_DRAW:a.DYNAMIC_DRAW,TRIANGLES:a.TRIANGLES,TRIANGLE_STRIP:a.TRIANGLE_STRIP,POINTS:a.POINTS,FRAMEBUFFER:a.FRAMEBUFFER,COLOR_ATTACHMENT0:a.COLOR_ATTACHMENT0,CLAMP_TO_EDGE:a.CLAMP_TO_EDGE,
LINEAR:a.LINEAR,NEAREST:a.NEAREST,MAG_FILTER:a.TEXTURE_MAG_FILTER,MIN_FILTER:a.TEXTURE_MIN_FILTER,WRAP_S:a.TEXTURE_WRAP_S,WRAP_T:a.TEXTURE_WRAP_T,TEXTURE0:a.TEXTURE0,TEXTURE1:a.TEXTURE1,TEXTURE2:a.TEXTURE2,UNIFORM_BUFFER:a.UNIFORM_BUFFER,PI:3.14149,M_PI:3.14149,M_2_PI:3.14149*3.14149,"2_PI":3.14149*3.14149,sin:Math.sin,cos:Math.cos,tan:Math.tan,random:Math.random,randFloat:ka,randInt:la,clamp:ma,range:Q};a instanceof WebGL2RenderingContext&&(e.COLOR_ATTACHMENT1=a.COLOR_ATTACHMENT1,e.COLOR_ATTACHMENT2=
a.COLOR_ATTACHMENT2,e.COLOR_ATTACHMENT3=a.COLOR_ATTACHMENT3,e.COLOR_ATTACHMENT4=a.COLOR_ATTACHMENT4,e.COLOR_ATTACHMENT5=a.COLOR_ATTACHMENT5);if(!window.GL_CONSTANTS_SET){for(var f in e)window[f]=e[f];window.GL_CONSTANTS_SET=!0}f=Object.assign(a.__proto__,d.__proto__);a.__proto__=f;Object.assign(a,d);if(300!==a.width||150!==a.height)a.canvas.width=a.width,a.canvas.height=a.height;if(c&&!a.isWebGL2){var c=na(a),h;for(h in c)a[h]=c[h]}return a}().setFullscreen().attachToScreen(),V=function(a,b,c,d){a=
void 0===a?60:a;b=void 0===b?window.innerWidth/window.innerHeight:b;c=void 0===c?.1:c;d=void 0===d?1E4:d;var e=pa();e.lookAt([0,0,0]);e.fov=a;e.near=c;e.far=d;e.aspect=b;e.name="perspective camera";k.perspective(e.projection,a,b,c,d);k.translate(e.view,e.view,[0,0,-10]);return e}(Math.PI/10*45,window.innerWidth/window.innerHeight,.1,100),V=function(a,b){a.hasOwnProperty("type")&&"camera"===a.type&&(a.zoom=b,a.position=[0,0,b],a.lookAt([0,0,0]),k.translate(a.view,a.view,[0,0,b]));return a}(V,-10),
ea=new T(za,V);(new ga).loadItem("./models/petal.obj","text").then(function(a){a=ha.parseObj(a);ea.setup(a);da()});window.addEventListener("resize",function(){var a=V;a.aspect=window.innerWidth/window.innerHeight;k.perspective(a.projection,a.fov,a.aspect,a.near,a.far);V=a})});
